<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="robots" content="index,follow"/><meta property="og:type" content="website"/><meta property="og:site_name" content="博客空间"/><meta property="twitter:domain" content="https://www.notion.so/Blog-351abd6d2fa847608085f6e40a7a46cd?pvs=4"/><meta name="description" content="Notion构建的博客空间测试"/><meta property="og:description" content="Notion构建的博客空间测试"/><meta name="twitter:description" content="Notion构建的博客空间测试"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:image" content="https://https/api/social-image?id=b02d7c09-9db4-480c-8082-a3631db20f71"/><meta property="og:image" content="https://https/api/social-image?id=b02d7c09-9db4-480c-8082-a3631db20f71"/><link rel="canonical" href="https://https://www.notion.so/Blog-351abd6d2fa847608085f6e40a7a46cd?pvs=4/vue2与vue3响应式原理与依赖收集详解"/><meta property="og:url" content="https://https://www.notion.so/Blog-351abd6d2fa847608085f6e40a7a46cd?pvs=4/vue2与vue3响应式原理与依赖收集详解"/><meta property="twitter:url" content="https://https://www.notion.so/Blog-351abd6d2fa847608085f6e40a7a46cd?pvs=4/vue2与vue3响应式原理与依赖收集详解"/><link rel="alternate" type="application/rss+xml" href="https://https://www.notion.so/Blog-351abd6d2fa847608085f6e40a7a46cd?pvs=4/feed" title="博客空间"/><meta property="og:title" content="Vue2与Vue3响应式原理与依赖收集详解"/><meta name="twitter:title" content="Vue2与Vue3响应式原理与依赖收集详解"/><title>Vue2与Vue3响应式原理与依赖收集详解</title><meta name="next-head-count" content="20"/><link rel="shortcut icon" href="/favicon.ico"/><link rel="icon" type="image/png" sizes="32x32" href="favicon.png"/><link rel="manifest" href="/manifest.json"/><link rel="preload" href="/_next/static/css/836d11bb8e359ad4.css" as="style"/><link rel="stylesheet" href="/_next/static/css/836d11bb8e359ad4.css" data-n-g=""/><link rel="preload" href="/_next/static/css/fbc289dea8b31870.css" as="style"/><link rel="stylesheet" href="/_next/static/css/fbc289dea8b31870.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script defer="" src="/_next/static/chunks/3607272e.ab03886d6dedf820.js"></script><script defer="" src="/_next/static/chunks/2037.75c4380288174e46.js"></script><script defer="" src="/_next/static/chunks/3358.a5a4bbbdd3ea5deb.js"></script><script src="/_next/static/chunks/webpack-0edb715e003ddf79.js" defer=""></script><script src="/_next/static/chunks/framework-d51ece3d757c7ed2.js" defer=""></script><script src="/_next/static/chunks/main-b9c49df2a4748b8d.js" defer=""></script><script src="/_next/static/chunks/pages/_app-da6dec5ae83d13eb.js" defer=""></script><script src="/_next/static/chunks/4878-ac7a80e9605f8855.js" defer=""></script><script src="/_next/static/chunks/5853-ced1283b2998adc4.js" defer=""></script><script src="/_next/static/chunks/pages/%5BpageId%5D-f03a3e108fb2a571.js" defer=""></script><script src="/_next/static/eKEPlPwVP5kYTeXwH8Gwx/_buildManifest.js" defer=""></script><script src="/_next/static/eKEPlPwVP5kYTeXwH8Gwx/_ssgManifest.js" defer=""></script></head><body><script>
/** Inlined version of noflash.js from use-dark-mode */
;(function () {
  var storageKey = 'darkMode'
  var classNameDark = 'dark-mode'
  var classNameLight = 'light-mode'
  function setClassOnDocumentBody(darkMode) {
    document.body.classList.add(darkMode ? classNameDark : classNameLight)
    document.body.classList.remove(darkMode ? classNameLight : classNameDark)
  }
  var preferDarkQuery = '(prefers-color-scheme: dark)'
  var mql = window.matchMedia(preferDarkQuery)
  var supportsColorSchemeQuery = mql.media === preferDarkQuery
  var localStorageTheme = null
  try {
    localStorageTheme = localStorage.getItem(storageKey)
  } catch (err) {}
  var localStorageExists = localStorageTheme !== null
  if (localStorageExists) {
    localStorageTheme = JSON.parse(localStorageTheme)
  }
  // Determine the source of truth
  if (localStorageExists) {
    // source of truth from localStorage
    setClassOnDocumentBody(localStorageTheme)
  } else if (supportsColorSchemeQuery) {
    // source of truth from system
    setClassOnDocumentBody(mql.matches)
    localStorage.setItem(storageKey, mql.matches)
  } else {
    // source of truth from document.body
    var isDarkMode = document.body.classList.contains(classNameDark)
    localStorage.setItem(storageKey, JSON.stringify(isDarkMode))
  }
})();
</script><div id="__next"><div class="notion notion-app light-mode notion-block-b02d7c099db4480c8082a3631db20f71"><div class="notion-viewport"></div><div class="notion-frame"><header class="notion-header"><div class="notion-nav-header"><div class="breadcrumbs"><a class="breadcrumb" href="/"><div class="notion-page-icon-inline notion-page-icon-span"><span class="icon notion-page-icon" role="img" aria-label="🍊">🍊</span></div><span class="title">Blog</span></a><span class="spacer">/</span><div class="breadcrumb active"><span class="title">Vue2与Vue3响应式原理与依赖收集详解</span></div></div><div role="button" class="breadcrumb button notion-search-button"><svg class="notion-icon searchIcon" viewBox="0 0 17 17"><path d="M6.78027 13.6729C8.24805 13.6729 9.60156 13.1982 10.709 12.4072L14.875 16.5732C15.0684 16.7666 15.3232 16.8633 15.5957 16.8633C16.167 16.8633 16.5713 16.4238 16.5713 15.8613C16.5713 15.5977 16.4834 15.3516 16.29 15.1582L12.1504 11.0098C13.0205 9.86719 13.5391 8.45215 13.5391 6.91406C13.5391 3.19629 10.498 0.155273 6.78027 0.155273C3.0625 0.155273 0.0214844 3.19629 0.0214844 6.91406C0.0214844 10.6318 3.0625 13.6729 6.78027 13.6729ZM6.78027 12.2139C3.87988 12.2139 1.48047 9.81445 1.48047 6.91406C1.48047 4.01367 3.87988 1.61426 6.78027 1.61426C9.68066 1.61426 12.0801 4.01367 12.0801 6.91406C12.0801 9.81445 9.68066 12.2139 6.78027 12.2139Z"></path></svg><span class="title">Search</span></div></div></header><div class="notion-page-scroller"><main class="notion-page notion-page-no-cover notion-page-no-icon notion-page-has-text-icon notion-full-page"><h1 class="notion-title">Vue2与Vue3响应式原理与依赖收集详解</h1><div class="notion-collection-page-properties"><div class="notion-collection-row"><div class="notion-collection-row-body"><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 4.568a.5.5 0 00-.5-.5h-6a.5.5 0 00-.5.5v1.046a.5.5 0 00.5.5h6a.5.5 0 00.5-.5V4.568zM.5 1a.5.5 0 00-.5.5v1.045a.5.5 0 00.5.5h12a.5.5 0 00.5-.5V1.5a.5.5 0 00-.5-.5H.5zM0 8.682a.5.5 0 00.5.5h11a.5.5 0 00.5-.5V7.636a.5.5 0 00-.5-.5H.5a.5.5 0 00-.5.5v1.046zm0 3.068a.5.5 0 00.5.5h9a.5.5 0 00.5-.5v-1.045a.5.5 0 00-.5-.5h-9a.5.5 0 00-.5.5v1.045z"></path></svg><div class="notion-collection-column-title-body">author</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-text"></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M6.986 14c-1.79 0-3.582-.69-4.944-2.068-2.723-2.72-2.723-7.172 0-9.892 2.725-2.72 7.182-2.72 9.906 0A6.972 6.972 0 0114 6.996c0 1.88-.728 3.633-2.052 4.955A7.058 7.058 0 016.986 14zm3.285-6.99v1.645H5.526v-5.47h1.841v3.63h2.904v.194zm1.89-.014c0-1.379-.542-2.67-1.522-3.648-2.006-2.005-5.287-2.007-7.297-.009l-.009.009a5.168 5.168 0 000 7.295c2.01 2.007 5.297 2.007 7.306 0a5.119 5.119 0 001.521-3.647z"></path></svg><div class="notion-collection-column-title-body">Created</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-created_time">Mar 8, 2023 03:29 AM</span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M4 3a1 1 0 011-1h7a1 1 0 110 2H5a1 1 0 01-1-1zm0 4a1 1 0 011-1h7a1 1 0 110 2H5a1 1 0 01-1-1zm0 4a1 1 0 011-1h7a1 1 0 110 2H5a1 1 0 01-1-1zM2 4a1 1 0 110-2 1 1 0 010 2zm0 4a1 1 0 110-2 1 1 0 010 2zm0 4a1 1 0 110-2 1 1 0 010 2z"></path></svg><div class="notion-collection-column-title-body">Tags</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-multi_select"><div class="notion-property-multi_select-item notion-item-blue">Vue</div></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M7 4.568a.5.5 0 00-.5-.5h-6a.5.5 0 00-.5.5v1.046a.5.5 0 00.5.5h6a.5.5 0 00.5-.5V4.568zM.5 1a.5.5 0 00-.5.5v1.045a.5.5 0 00.5.5h12a.5.5 0 00.5-.5V1.5a.5.5 0 00-.5-.5H.5zM0 8.682a.5.5 0 00.5.5h11a.5.5 0 00.5-.5V7.636a.5.5 0 00-.5-.5H.5a.5.5 0 00-.5.5v1.046zm0 3.068a.5.5 0 00.5.5h9a.5.5 0 00.5-.5v-1.045a.5.5 0 00-.5-.5h-9a.5.5 0 00-.5.5v1.045z"></path></svg><div class="notion-collection-column-title-body">Category</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-text"></span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M6.986 14c-1.79 0-3.582-.69-4.944-2.068-2.723-2.72-2.723-7.172 0-9.892 2.725-2.72 7.182-2.72 9.906 0A6.972 6.972 0 0114 6.996c0 1.88-.728 3.633-2.052 4.955A7.058 7.058 0 016.986 14zm3.285-6.99v1.645H5.526v-5.47h1.841v3.63h2.904v.194zm1.89-.014c0-1.379-.542-2.67-1.522-3.648-2.006-2.005-5.287-2.007-7.297-.009l-.009.009a5.168 5.168 0 000 7.295c2.01 2.007 5.297 2.007 7.306 0a5.119 5.119 0 001.521-3.647z"></path></svg><div class="notion-collection-column-title-body">Last edited time</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-last_edited_time">Last updated March 8, 2023</span></div></div><div class="notion-collection-row-property"><div class="notion-collection-column-title"><svg viewBox="0 0 14 14" class="notion-collection-column-title-icon"><path d="M10.889 5.5H3.11v1.556h7.778V5.5zm1.555-4.444h-.777V0H10.11v1.056H3.89V0H2.333v1.056h-.777c-.864 0-1.548.7-1.548 1.555L0 12.5c0 .856.692 1.5 1.556 1.5h10.888C13.3 14 14 13.356 14 12.5V2.611c0-.855-.7-1.555-1.556-1.555zm0 11.444H1.556V3.944h10.888V12.5zM8.556 8.611H3.11v1.556h5.445V8.61z"></path></svg><div class="notion-collection-column-title-body">Date</div></div><div class="notion-collection-row-value"><span class="notion-property notion-property-date"></span></div></div></div></div></div><div class="notion-page-content notion-page-content-has-aside notion-page-content-has-toc"><article class="notion-page-content-inner"><div class="notion-blank notion-block-a7aa2ea39ff34b8d972bb222f2e122e7"> </div><div class="notion-text notion-block-6165f650dbc247a2a9079037cc91d28d">高级前端进阶 <!-- --> <em>2023-03-02 09:10</em> <em>发表于浙江</em></div><div class="notion-text notion-block-4ce7dd07f05b430992024b6b07aa0472">以下文章来源于MiyueFE 的前端圈 ，作者MiyueFE</div><div class="notion-text notion-block-5052ca8dcc914969845c3abcafd8762d"><a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://mp.weixin.qq.com/s?__biz=MzA4Nzg0MDM5Nw==&amp;mid=2247516897&amp;idx=1&amp;sn=f39eea5519e5030e4f90486730f32289&amp;key=bd40c5f4b2f52e015c023b573b440be2611c95b6f4e4ff73d4d308edfcab7bdd32185beaf2045478e8c09f306834e33b4ee0aff2f9953779e401c747efc49833da285854e36964499cd40005c692976d2b33801c7fefaa1af4e7e101586aab72dc47eed826a7884e71774a2cd23339366742a568a9530a4af211050c8443cda3&amp;ascene=0&amp;uin=MTUyNzU1NTAyOA%3D%3D&amp;devicetype=iMac+MacBookPro16%2C1+OSX+OSX+13.2.1+build(22D68)&amp;version=13070011&amp;nettype=WIFI&amp;lang=zh_CN&amp;countrycode=CN&amp;fontScale=100&amp;exportkey=n_ChQIAhIQNl04xcbdhvzYP8Cm%2FWTYaBKCAgIE97dBBAEAAAAAANOhCUFZkAYAAAAOpnltbLcz9gKNyK89dVj0yQwAQSvAeYLgD6lUF87Gn%2FYvy%2FlkznY41ltqTXmTcvYycABnlRU5yN568IcySNcbMFHD8DDTfY75tSwTR7KCabvD5cqG1InNnEmI9eIbDmn7YWRtkh%2B1qC%2BybZLq%2F2VEbcN0XWbyrzOJmVNpHMvtIt8XqZOUPgvaZKknK3SV3sXunBw4BPFzBUtdA15QQ7BV%2BfphAUipFeWGvaFEwbBHRxYK01ByGfL%2FkUOcexALRD%2FKvr6%2FHr3lp5iaTjVYC4U91bcAOrZhclTl4GtF8vaCfPkN1aPH%2FfcxqSErVw%3D%3D&amp;acctmode=0&amp;pass_ticket=29C%2BK84WJDGNWmYYkoIQMVRxwYOX0zfGMDCklz%2Fo9OkGjIHzMX2xSMzCRttDah%2F64apwTp36IeCaPDtuEOSl4g%3D%3D&amp;wx_header=0#"><b>MiyueFE 的前端圈</b></a><a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://mp.weixin.qq.com/s?__biz=MzA4Nzg0MDM5Nw==&amp;mid=2247516897&amp;idx=1&amp;sn=f39eea5519e5030e4f90486730f32289&amp;key=bd40c5f4b2f52e015c023b573b440be2611c95b6f4e4ff73d4d308edfcab7bdd32185beaf2045478e8c09f306834e33b4ee0aff2f9953779e401c747efc49833da285854e36964499cd40005c692976d2b33801c7fefaa1af4e7e101586aab72dc47eed826a7884e71774a2cd23339366742a568a9530a4af211050c8443cda3&amp;ascene=0&amp;uin=MTUyNzU1NTAyOA%3D%3D&amp;devicetype=iMac+MacBookPro16%2C1+OSX+OSX+13.2.1+build(22D68)&amp;version=13070011&amp;nettype=WIFI&amp;lang=zh_CN&amp;countrycode=CN&amp;fontScale=100&amp;exportkey=n_ChQIAhIQNl04xcbdhvzYP8Cm%2FWTYaBKCAgIE97dBBAEAAAAAANOhCUFZkAYAAAAOpnltbLcz9gKNyK89dVj0yQwAQSvAeYLgD6lUF87Gn%2FYvy%2FlkznY41ltqTXmTcvYycABnlRU5yN568IcySNcbMFHD8DDTfY75tSwTR7KCabvD5cqG1InNnEmI9eIbDmn7YWRtkh%2B1qC%2BybZLq%2F2VEbcN0XWbyrzOJmVNpHMvtIt8XqZOUPgvaZKknK3SV3sXunBw4BPFzBUtdA15QQ7BV%2BfphAUipFeWGvaFEwbBHRxYK01ByGfL%2FkUOcexALRD%2FKvr6%2FHr3lp5iaTjVYC4U91bcAOrZhclTl4GtF8vaCfPkN1aPH%2FfcxqSErVw%3D%3D&amp;acctmode=0&amp;pass_ticket=29C%2BK84WJDGNWmYYkoIQMVRxwYOX0zfGMDCklz%2Fo9OkGjIHzMX2xSMzCRttDah%2F64apwTp36IeCaPDtuEOSl4g%3D%3D&amp;wx_header=0#">.</a><a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://mp.weixin.qq.com/s?__biz=MzA4Nzg0MDM5Nw==&amp;mid=2247516897&amp;idx=1&amp;sn=f39eea5519e5030e4f90486730f32289&amp;key=bd40c5f4b2f52e015c023b573b440be2611c95b6f4e4ff73d4d308edfcab7bdd32185beaf2045478e8c09f306834e33b4ee0aff2f9953779e401c747efc49833da285854e36964499cd40005c692976d2b33801c7fefaa1af4e7e101586aab72dc47eed826a7884e71774a2cd23339366742a568a9530a4af211050c8443cda3&amp;ascene=0&amp;uin=MTUyNzU1NTAyOA%3D%3D&amp;devicetype=iMac+MacBookPro16%2C1+OSX+OSX+13.2.1+build(22D68)&amp;version=13070011&amp;nettype=WIFI&amp;lang=zh_CN&amp;countrycode=CN&amp;fontScale=100&amp;exportkey=n_ChQIAhIQNl04xcbdhvzYP8Cm%2FWTYaBKCAgIE97dBBAEAAAAAANOhCUFZkAYAAAAOpnltbLcz9gKNyK89dVj0yQwAQSvAeYLgD6lUF87Gn%2FYvy%2FlkznY41ltqTXmTcvYycABnlRU5yN568IcySNcbMFHD8DDTfY75tSwTR7KCabvD5cqG1InNnEmI9eIbDmn7YWRtkh%2B1qC%2BybZLq%2F2VEbcN0XWbyrzOJmVNpHMvtIt8XqZOUPgvaZKknK3SV3sXunBw4BPFzBUtdA15QQ7BV%2BfphAUipFeWGvaFEwbBHRxYK01ByGfL%2FkUOcexALRD%2FKvr6%2FHr3lp5iaTjVYC4U91bcAOrZhclTl4GtF8vaCfPkN1aPH%2FfcxqSErVw%3D%3D&amp;acctmode=0&amp;pass_ticket=29C%2BK84WJDGNWmYYkoIQMVRxwYOX0zfGMDCklz%2Fo9OkGjIHzMX2xSMzCRttDah%2F64apwTp36IeCaPDtuEOSl4g%3D%3D&amp;wx_header=0#">
</a><a target="_blank" rel="noopener noreferrer" class="notion-link" href="https://mp.weixin.qq.com/s?__biz=MzA4Nzg0MDM5Nw==&amp;mid=2247516897&amp;idx=1&amp;sn=f39eea5519e5030e4f90486730f32289&amp;key=bd40c5f4b2f52e015c023b573b440be2611c95b6f4e4ff73d4d308edfcab7bdd32185beaf2045478e8c09f306834e33b4ee0aff2f9953779e401c747efc49833da285854e36964499cd40005c692976d2b33801c7fefaa1af4e7e101586aab72dc47eed826a7884e71774a2cd23339366742a568a9530a4af211050c8443cda3&amp;ascene=0&amp;uin=MTUyNzU1NTAyOA%3D%3D&amp;devicetype=iMac+MacBookPro16%2C1+OSX+OSX+13.2.1+build(22D68)&amp;version=13070011&amp;nettype=WIFI&amp;lang=zh_CN&amp;countrycode=CN&amp;fontScale=100&amp;exportkey=n_ChQIAhIQNl04xcbdhvzYP8Cm%2FWTYaBKCAgIE97dBBAEAAAAAANOhCUFZkAYAAAAOpnltbLcz9gKNyK89dVj0yQwAQSvAeYLgD6lUF87Gn%2FYvy%2FlkznY41ltqTXmTcvYycABnlRU5yN568IcySNcbMFHD8DDTfY75tSwTR7KCabvD5cqG1InNnEmI9eIbDmn7YWRtkh%2B1qC%2BybZLq%2F2VEbcN0XWbyrzOJmVNpHMvtIt8XqZOUPgvaZKknK3SV3sXunBw4BPFzBUtdA15QQ7BV%2BfphAUipFeWGvaFEwbBHRxYK01ByGfL%2FkUOcexALRD%2FKvr6%2FHr3lp5iaTjVYC4U91bcAOrZhclTl4GtF8vaCfPkN1aPH%2FfcxqSErVw%3D%3D&amp;acctmode=0&amp;pass_ticket=29C%2BK84WJDGNWmYYkoIQMVRxwYOX0zfGMDCklz%2Fo9OkGjIHzMX2xSMzCRttDah%2F64apwTp36IeCaPDtuEOSl4g%3D%3D&amp;wx_header=0#">专注前端学习，从入门到养生，主要分享个人在前端学习中遇见的好文章以及个人理解，文笔不好，还请大家谅解。</a></div><h3 class="notion-h notion-h2 notion-h-indent-0 notion-block-d7a8d1b075b44df28e4ffcc48a9952ab" data-id="d7a8d1b075b44df28e4ffcc48a9952ab"><span><div id="d7a8d1b075b44df28e4ffcc48a9952ab" class="notion-header-anchor"></div><a class="notion-hash-link" href="#d7a8d1b075b44df28e4ffcc48a9952ab" title="前言"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title"><b>前言</b></span></span></h3><div class="notion-text notion-block-7dfae6fc7f4f4c4bb30eb69e91d3a313">继 Angular 和 React 之后，尤大在 2016 年发布了如今“前端三剑客”之一的 Vue 2.0，并凭借其简单易用、轻量高效的特点受到了广泛的欢迎，特别是在国内环境中。然而 Vue 2 中基于 <code class="notion-inline-code">Object.defineProperty</code> 实现的响应式系统，随着 JavaScript 与浏览器技术的不断升级，其缺陷也愈加明显~</div><div class="notion-text notion-block-5056afeb5ff043ab87f5124da178910f">所以 Vue 团队在 Vue 2 的基础上，通过基于 <code class="notion-inline-code">Proxy</code> 的全新响应式系统发布了 Vue 3.0，带来了更好的性能表现。</div><div class="notion-text notion-block-84de292d119241a89b3cbe868a516b3d">本文将深入剖析 Vue 2 与 Vue 3 的响应式系统实现，解释其实现原理和优势对比，如果你正在学习和了解 Vue 源码相关的内容，那本文肯定值得一看~</div><h3 class="notion-h notion-h2 notion-h-indent-0 notion-block-6cb2fb736c044151a2ad30575a860350" data-id="6cb2fb736c044151a2ad30575a860350"><span><div id="6cb2fb736c044151a2ad30575a860350" class="notion-header-anchor"></div><a class="notion-hash-link" href="#6cb2fb736c044151a2ad30575a860350" title="Vue 的响应式系统设计思路"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title"><b>Vue 的响应式系统设计思路</b></span></span></h3><div class="notion-text notion-block-43dce486a72847f2a776c7d833534c63">虽然 Vue 2 与 Vue 3 实现响应式系统的方式不同，但是他们的核心思想还是一致的，都是通过 <b>发布-订阅模式</b> 来实现（因为发布者和观察者之间多了一个 <b>dependence</b> 依赖收集者，与传统观察者模式不同）。</div><blockquote class="notion-quote notion-block-6903797f7af04048b64684cccfa9ec30"><div>个人理解，观察者模式 与 发布-订阅模式 都是 消息传递的一种实现方式，用来实现 对象间的通信（消息传递），只是发布订阅模式可以看做是观察者模式的 升级版，避免了 被观察对象与观察者之间的直接联系。</div></blockquote><div class="notion-text notion-block-c600905ed50547d48eb9dbe537f0e982">观察者模式：一个被观察对象对应多个观察者，两者直接联系；被观察这改变时直接向所有观察者发送消息（调用观察者的更新方法）</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-6a3f2215766749a0a68bd17218e4acff"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%272000%27%20height=%271271%27/%3e"/></span><img alt="notion image" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%;background-size:cover;background-position:0% 0%;filter:blur(20px);background-image:url(&quot;data:image/webp;base64,UklGRiwAAABXRUJQVlA4ICAAAABQAQCdASoQAAoABUB8JZwABAAAAP7wS2Blkfrlc4AAAA==&quot;)"/><noscript><img alt="notion image" src="https://www.notion.so/image/https%3A%2F%2Fmmbiz.qpic.cn%2Fmmbiz_png%2Fpman3QtrTawViclZEmHCpYTwM69daBBiaoGRGpqibW0KVxLI9vVhjJpnGxrpiaf5LxxaehyweiarUlPedNCKLvCkTpw%2F640%3Fwx_fmt%3Dpng%26wxfrom%3D5%26wx_lazy%3D1%26wx_co%3D1?table=block&amp;id=6a3f2215-7667-49a0-a68b-d17218e4acff&amp;cache=v2" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div></figure><div class="notion-text notion-block-a0841ad4e67048789d45a19264d6d124">image-20230220161149634.png</div><div class="notion-text notion-block-40a423716bf44733b6f55f4f535c2b2c">发布订阅模式：被观察对象与观察者之间可能是 <b>多对多</b> 的关系，两者都可以绑定多个另一角色；而两个角色之间还有一个 <b>依赖收集和管理</b> 的角色（提供一些观察者的操作方法）。</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-dfed423a41184cdf8aea8d74aa7006b9"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%272000%27%20height=%271240%27/%3e"/></span><img alt="notion image" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%;background-size:cover;background-position:0% 0%;filter:blur(20px);background-image:url(&quot;data:image/webp;base64,UklGRioAAABXRUJQVlA4IB4AAAAwAQCdASoQAAoABUB8JaQAA3AA/vAwNKVIb9IAAAA=&quot;)"/><noscript><img alt="notion image" src="https://www.notion.so/image/https%3A%2F%2Fmmbiz.qpic.cn%2Fmmbiz_png%2Fpman3QtrTawViclZEmHCpYTwM69daBBiaob6eth9iaNXTgtPH4jIESUUNeRJta6g2mOXLjzMOCdqK6uEhMNZgP0xQ%2F640%3Fwx_fmt%3Dpng%26wxfrom%3D5%26wx_lazy%3D1%26wx_co%3D1?table=block&amp;id=dfed423a-4118-4cdf-8aea-8d74aa7006b9&amp;cache=v2" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div></figure><blockquote class="notion-quote notion-block-369c4133084f41baa6240bcff47f8fcc"><div>在 Vue 中我们视图中依赖的每一个数据其实就是一个被观察者，我们的视图渲染函数（renderWatcher）和其他的 watcher/effect 函数则都是订阅者。</div></blockquote><div class="notion-text notion-block-4449805292854573af1a080751d901cf">当数据改变时，就会发送一个事件去触发我们的观察者进行更新，即视图更新。</div><h3 class="notion-h notion-h2 notion-h-indent-0 notion-block-13697af900984d938cc386d519acbadd" data-id="13697af900984d938cc386d519acbadd"><span><div id="13697af900984d938cc386d519acbadd" class="notion-header-anchor"></div><a class="notion-hash-link" href="#13697af900984d938cc386d519acbadd" title="Vue 2 的响应式实现"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title"><b>Vue 2 的响应式实现</b></span></span></h3><div class="notion-text notion-block-c6c21a4bf7e34e7e8dedd18c0ddcf7b5">刚刚我们简述了一下 Vue 实现响应式的基础方案，就是通过发布订阅模式收集数据依赖，当数据更新时触发 render 等一系列 Watcher 函数的执行来实现视图更新的。</div><div class="notion-text notion-block-67210637d52f4083b4d9ce9f34a25af0">大家也都知道 Vue 2 是通过 <code class="notion-inline-code">Object.defineProperty</code> 来实现数据 <b>读取和更新时的操作劫持</b>，通过更改默认的 <b>getter/setter</b> 函数，在 <b>get</b> 过程中收集依赖，在 <b>set</b> 过程中派发更新的。</div><div class="notion-text notion-block-5b66acc4c46e4afcb09c9e05919d0881">我们可以通过下面的简易代码来分析：</div><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">// 响应式数据处理，构造一个响应式对象
class Observer {
  constructor(data) {
    this.data = data
    this.walk(data)
  }

// 遍历对象的每个 已定义 属性，分别执行 defineReactive
  walk(data) {
    if (!data || typeof data !== &#x27;object&#x27;) {
      return
    }

    Object.keys(data).forEach(key =&gt; {
      this.defineReactive(data, key, data[key])
    })
  }

// 为对象的每个属性重新设置 getter/setter
  defineReactive(obj, key, val) {
// 每个属性都有单独的 dep 依赖管理
    const dep = new Dep()

// 通过 defineProperty 进行操作代理定义
    Object.defineProperty(obj, key, {
      enumerable: true,
      configurable: true,
// 值的读取操作，进行依赖收集
      get() {
        if (Dep.target) {
          dep.depend()
        }
        return val
      },
// 值的更新操作，触发依赖更新
      set(newVal) {
        if (newVal === val) {
          return
        }
        val = newVal
        dep.notify()
      }
    })
  }
}

// 观察者的构造函数，接收一个表达式和回调函数
class Watcher {
  constructor(vm, expOrFn, cb) {
    this.vm = vm //Observer
    this.getter = parsePath(expOrFn)
    this.cb = cb
    this.value = this.get()
  }

// watcher 实例触发值读取时，将依赖收集的目标对象设置成自身，
// 通过 call 绑定当前 Vue 实例进行一次函数执行，在运行过程中收集函数中用到的数据
// 此时会在所有用到数据的 dep 依赖管理中插入该观察者实例
  get() {
    Dep.target = this
    const value = this.getter.call(this.vm, this.vm)
// 函数执行完毕后将依赖收集目标清空，避免重复收集
    Dep.target = null
    return value
  }

// dep 依赖更新时会调用，执行回调函数
  update() {
    const oldValue = this.value
    this.value = this.get()
    this.cb.call(this.vm, this.value, oldValue)
  }
}

// 依赖收集管理者的构造函数
class Dep {
  constructor() {
// 保存所有 watcher 观察者依赖数组
    this.subs = []
  }

// 插入一个观察者到依赖数组中
  addSub(sub) {
    this.subs.push(sub)
  }

// 收集依赖，只有此时的依赖目标（watcher 实例）存在时才收集依赖
  depend() {
    if (Dep.target) {
      this.addSub(Dep.target)
    }
  }

// 发送更新，遍历依赖数组分别执行每个观察者定义好的 update 方法
  notify() {
    this.subs.forEach(sub =&gt; {
      sub.update()
    })
  }
}

// 当前依赖收集的目标对象
Dep.target = null

// 表达式解析
function parsePath(path) {
  const segments = path.split(&#x27;.&#x27;)
  return function (obj) {
    for (let i = 0; i &lt; segments.length; i++) {
      if (!obj) {
        return
      }
      obj = obj[segments[i]]
    }
    return obj
  }
}
</code></pre><blockquote class="notion-quote notion-block-3fab77dbabc649aeab593850c9947feb"><div>这里省略了数组部分，但是 数组本身的响应式监听 是通过重写数组方法来实现的，而 每个数组元素 则会再次进行 Observer 处理（需要数组在定义时就已经声明的数组元素）。</div></blockquote><div class="notion-text notion-block-113f7e9602414ca3b33115f97c0ab639">当然，因为 <b>Object.definePorperty</b> 只能对 <b>对象的已知属性</b> 进行操作，所有才会导致 <b>没有在 data 中进行声明的对象属性直接赋值时无法触发视图更新，需要通过魔法（</b><code class="notion-inline-code"><b>$set</b></code><b>）来处理</b>。而数组也应为是通过重新数组方法和遍历数组元素进行的响应式处理，也会导致按照数组下标进行赋值或者更改元素时无法触发视图更新。</div><div class="notion-text notion-block-b42d2e6093ba4866b36079a065b66d69">例如：</div><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-plain text">&lt;body&gt;
  &lt;div id=&quot;app&quot; class=&quot;demo-vm-1&quot;&gt;
    &lt;p&gt;{{arr[0]}}&lt;/p&gt;
    &lt;p&gt;{{arr[2]}}&lt;/p&gt;
    &lt;p&gt;{{arr[3].c}}&lt;/p&gt;
  &lt;/div&gt;
&lt;/body&gt;

&lt;script&gt;
  new Vue({
    el: &quot;#app&quot;,
    data() {
      return {
        arr: [1, 2, { a: 3 },{ c: 5 }]
      }
    },
    mounted() {
      console.log(&quot;demo Instance: &quot;, this.$data);

      setTimeout(() =&gt; {
        console.log(&#x27;update&#x27;)
        this.arr[0] = { o: 1 }
        this.arr[2] = { a: 1 }
      },2000)
    },
  })
&lt;/script&gt;</code></pre><div class="notion-text notion-block-0319d0bf1ad649b8aac83e4f1a352393">因为数组元素的前三个元素 <b>在定义时都是简单类型</b>，所以即使在模板中使用了该数据，也无法进行依赖收集和更新响应：</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-9de28176010049a49e37c965dcf7f332"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%272000%27%20height=%272116%27/%3e"/></span><img alt="notion image" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%;background-size:cover;background-position:0% 0%;filter:blur(20px);background-image:url(&quot;data:image/webp;base64,UklGRiwAAABXRUJQVlA4ICAAAAAwAQCdASoPABAABUB8JaQAA3AA/vBilv+6bal6gbAAAA==&quot;)"/><noscript><img alt="notion image" src="https://www.notion.so/image/https%3A%2F%2Fmmbiz.qpic.cn%2Fmmbiz_png%2Fpman3QtrTawViclZEmHCpYTwM69daBBiaobASpEU3Hhcm3hKiagEhFLsIDt97O9ibu2KIxvDN7rEsrVWAl7Q8hmrTw%2F640%3Fwx_fmt%3Dpng%26wxfrom%3D5%26wx_lazy%3D1%26wx_co%3D1?table=block&amp;id=9de28176-0100-49a4-9e37-c965dcf7f332&amp;cache=v2" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div></figure><div class="notion-text notion-block-66085b495f8442a6be59bf37d2fa569d">而本身的 <code class="notion-inline-code">data</code> 返回对象与 <code class="notion-inline-code">arr, arr[3]</code> 都有各自的 <code class="notion-inline-code">dep</code> 依赖数组，并且 <code class="notion-inline-code">arr</code> 和 <code class="notion-inline-code">arr[3]</code> 的依赖中都有同一个 <code class="notion-inline-code">Watcher</code> —— <code class="notion-inline-code">RenderWacther</code> 模板渲染。</div><blockquote class="notion-quote notion-block-18af235520ee431295f4450ee4148b55"><div>当然整个响应系统还包含依赖清理等其他操作，具体过程可以查看 Vue 2 阅读理解（十八）之响应式系统（一 ~ 四）Watcher</div></blockquote><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-500117a3be904f778daa302b170453a6"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:360px"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Ffile.notion.so%2Ff%2Fs%2F6a41814e-b5b7-4143-a4d8-35195bc24e98%2FUntitled.png%3Ftable%3Dblock%26id%3D500117a3-be90-4f77-8daa-302b170453a6%26expirationTimestamp%3D1679021228476%26signature%3DjQMadO6xnGOV2TclXGyJa7M9g6_MUxBYXl-VZXFymUY?table=block&amp;id=500117a3-be90-4f77-8daa-302b170453a6&amp;cache=v2" alt="notion image" loading="lazy" decoding="async"/></div></figure><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-e1cc7f7812044fc5bf0e60e0417ea4c3"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column"><img src="data:image/svg+xml,%3C%3Fxml version=&#x27;1.0&#x27; encoding=&#x27;UTF-8&#x27;%3F%3E%3Csvg width=&#x27;1px&#x27; height=&#x27;1px&#x27; viewBox=&#x27;0 0 1 1&#x27; version=&#x27;1.1&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; xmlns:xlink=&#x27;http://www.w3.org/1999/xlink&#x27;%3E%3Ctitle%3E%3C/title%3E%3Cg stroke=&#x27;none&#x27; stroke-width=&#x27;1&#x27; fill=&#x27;none&#x27; fill-rule=&#x27;evenodd&#x27; fill-opacity=&#x27;0&#x27;%3E%3Cg transform=&#x27;translate(-249.000000, -126.000000)&#x27; fill=&#x27;%23FFFFFF&#x27;%3E%3Crect x=&#x27;249&#x27; y=&#x27;126&#x27; width=&#x27;1&#x27; height=&#x27;1&#x27;%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E" alt="notion image" loading="lazy" decoding="async"/></div></figure><h3 class="notion-h notion-h2 notion-h-indent-0 notion-block-cdd06622d853483aa4e9d8bb71c9c8f3" data-id="cdd06622d853483aa4e9d8bb71c9c8f3"><span><div id="cdd06622d853483aa4e9d8bb71c9c8f3" class="notion-header-anchor"></div><a class="notion-hash-link" href="#cdd06622d853483aa4e9d8bb71c9c8f3" title="Vue 3 的响应式实现"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title"><b>Vue 3 的响应式实现</b></span></span></h3><div class="notion-text notion-block-11d62ff49d1b4049be7c217cab0f01ba">碍于 <code class="notion-inline-code">Object.defineProperty</code> 的局限性，Vue 3 采用了全新的 <code class="notion-inline-code">Proxy</code> 对象来实现整个响应式系统基础。</div><h4 class="notion-h notion-h3 notion-h-indent-1 notion-block-7c5402b1b8db4670a0616def4dbf6db5" data-id="7c5402b1b8db4670a0616def4dbf6db5"><span><div id="7c5402b1b8db4670a0616def4dbf6db5" class="notion-header-anchor"></div><a class="notion-hash-link" href="#7c5402b1b8db4670a0616def4dbf6db5" title="什么是 Proxy ？"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title"><b>什么是 Proxy ？</b></span></span></h4><div class="notion-text notion-block-ce48ddc6adda484a8ab33628a4f29b78"><code class="notion-inline-code">Proxy</code> 是 <code class="notion-inline-code">ES6</code> 新增的一个构造函数，用来创建一个 <b>目标对象的代理对象，拦截对原对象的所有操作；用户可以通过注册相应的拦截方法来实现对象操作时的自定义行为</b>。</div><div class="notion-text notion-block-afa8f16db9a647b690ab0dc5a2655a80">目前 <code class="notion-inline-code">Proxy</code> 支持的拦截方法包含一下内容：</div><ul class="notion-list notion-list-disc notion-block-ebbc3278a80d4f6095febeb4c024081e"><li><code class="notion-inline-code">get(target, propKey, receiver)</code>：拦截对象属性的读取操作；</li></ul><ul class="notion-list notion-list-disc notion-block-5f339f577b82499ebf698e2b660092f9"><li><code class="notion-inline-code">set(target, propKey, value, receiver)</code>：拦截对象属性的赋值操作；</li></ul><ul class="notion-list notion-list-disc notion-block-341baaef44ff45058b33d8368fbf21d6"><li><code class="notion-inline-code">apply(target, thisArg, argArray)</code>：拦截函数的调用操作；</li></ul><ul class="notion-list notion-list-disc notion-block-b8d5407814b54aac891b9fb1fa130994"><li><code class="notion-inline-code">construct(target, argArray, newTarget)</code>：拦截对象的实例化操作；</li></ul><ul class="notion-list notion-list-disc notion-block-affa42e315214effb7a33d9cda7f6658"><li><code class="notion-inline-code">has(target, propKey)</code>：拦截 <code class="notion-inline-code">in</code> 操作符；</li></ul><ul class="notion-list notion-list-disc notion-block-e59eb0719aed441eaf7a13f497f8297a"><li><code class="notion-inline-code">deleteProperty(target, propKey)</code>：拦截 <code class="notion-inline-code">delete</code> 操作符；</li></ul><ul class="notion-list notion-list-disc notion-block-e1443c27ea1a4ab69a2dcb1923895d86"><li><code class="notion-inline-code">defineProperty(target, propKey, propDesc)</code>：拦截 <code class="notion-inline-code">Object.defineProperty</code> 方法；</li></ul><ul class="notion-list notion-list-disc notion-block-0c4d590439cf4d2db0169a70bc099ddb"><li><code class="notion-inline-code">getOwnPropertyDescriptor(target, propKey)</code>：拦截 <code class="notion-inline-code">Object.getOwnPropertyDescriptor</code> 方法；</li></ul><ul class="notion-list notion-list-disc notion-block-7c9c0e16d4534c59bc94da17d8c419bf"><li><code class="notion-inline-code">getPrototypeOf(target)</code>：拦截 <code class="notion-inline-code">Object.getPrototypeOf</code> 方法；</li></ul><ul class="notion-list notion-list-disc notion-block-f12643b0c52143eda83ee094d821e428"><li><code class="notion-inline-code">setPrototypeOf(target, proto)</code>：拦截 <code class="notion-inline-code">Object.setPrototypeOf</code> 方法；</li></ul><ul class="notion-list notion-list-disc notion-block-8c4d25dfb13e485390dea0e1334f25bb"><li><code class="notion-inline-code">isExtensible(target)</code>：拦截 <code class="notion-inline-code">Object.isExtensible</code> 方法；</li></ul><ul class="notion-list notion-list-disc notion-block-4071f8a5a2614febbffb0130ace83fa1"><li><code class="notion-inline-code">preventExtensions(target)</code>：拦截 <code class="notion-inline-code">Object.preventExtensions</code> 方法；</li></ul><ul class="notion-list notion-list-disc notion-block-186444d7d4434647b87918f7a7585d2f"><li><code class="notion-inline-code">enumerate(target)</code>：拦截 <code class="notion-inline-code">for...in</code> 循环；</li></ul><ul class="notion-list notion-list-disc notion-block-0b0a3e42c9514f8a82175174a7c5cc89"><li><code class="notion-inline-code">ownKeys(target)</code>：拦截 <code class="notion-inline-code">Object.getOwnPropertyNames</code>、<code class="notion-inline-code">Object.getOwnPropertySymbols</code>、<code class="notion-inline-code">Object.keys</code>、<code class="notion-inline-code">JSON.stringify</code> 方法。</li></ul><div class="notion-text notion-block-6ed7f0bf3bb749fe9134ad6c1c10e994">与 <code class="notion-inline-code">Object,defineProperty</code> 比起来，有非常明显的优势：</div><ul class="notion-list notion-list-disc notion-block-0d0f973ad51347439a716da53f32a6a2"><li>拦截操作更加多样</li></ul><ul class="notion-list notion-list-disc notion-block-2ed16b7e6164456ab9a2d27a73696460"><li>拦截定义更加直接</li></ul><ul class="notion-list notion-list-disc notion-block-0ccdb098b4fb4822b57a98f495927a81"><li>性能更加高效</li></ul><div class="notion-text notion-block-a6af69270fb54a28b65e5dfd0b8b7bec">在 Vue 中体现最为明显的一点就是：<code class="notion-inline-code">Proxy</code> 代理对象之后不仅可以拦截对象属性的读取、更新、方法调用之外，对整个对象的新增、删除、枚举等也能直接拦截，而 <code class="notion-inline-code">Object.defineProperty</code> 只能针对对象的已知属性进行读取和更新的操作拦截。</div><div class="notion-text notion-block-5375187d13cb43548d4678bfe3055dd9">例如：</div><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-plain text">const obj = { name: &#x27;MiyueFE&#x27;, age: 28 };
const proxyObj = new Proxy(obj, {
  get(target, property) {
    console.log(`Getting ${property} value: ${target[property]}`);
    return target[property];
  },
  set(target, property, value) {
    console.log(`Setting ${property} value: ${value}`);
    target[property] = value;
  },
  deleteProperty(target, property) {
    console.log(`Deleting ${property} property`);
    delete target[property];
  },
});

console.log(proxyObj.name);// Getting name value: MiyueFE, 输出 &quot;MiyueFE&quot;
proxyObj.name = &#x27;MY&#x27;;// Setting name value: MY
console.log(proxyObj.name);// Getting name value: MY, 输出 &quot;MY&quot;
delete proxyObj.age;// Deleting age property
console.log(proxyObj.age);// undefined</code></pre><blockquote class="notion-quote notion-block-5b78973213384ced8d14261f48271f62"><div>但是 只有通过 proxyObj 进行操作的时候才能通过定义的操作拦截方法进行处理，直接使用原对象则无法触发拦截器。</div><div class="notion-text notion-block-0fb792aa906543a289d50472c3e529a8">这也是 Vue 3 中要求的 <code class="notion-inline-code">reactive</code> 声明的对象修改原对象无法触发视图更新的原因。</div><div class="notion-text notion-block-90b4c8d2858341bf9a0196b2e393d960">并且 <code class="notion-inline-code">Proxy</code> 也只针对 <b>引用类型数据</b> 才能进行代理，所以这也是 Vue 的基础数据都需要通过 <code class="notion-inline-code">ref</code> 进行声明的原因，内部会建立一个新对象保存原有的基础数据值。</div></blockquote><div class="notion-text notion-block-f428a7de1d49414fb3049db35ad4a5ea">例如：</div><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-plain text">// 接上面的代码
obj.name = &quot;newName&quot;;// &quot;newName&quot;
console.log(proxyObj.name);// Getting name value: newName;  &quot;newName&quot;</code></pre><h4 class="notion-h notion-h3 notion-h-indent-1 notion-block-cf0ce65a09c5435eb1f1e111197a60e7" data-id="cf0ce65a09c5435eb1f1e111197a60e7"><span><div id="cf0ce65a09c5435eb1f1e111197a60e7" class="notion-header-anchor"></div><a class="notion-hash-link" href="#cf0ce65a09c5435eb1f1e111197a60e7" title="响应式的实现"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title"><b>响应式的实现</b></span></span></h4><div class="notion-text notion-block-a78532a0bd6a40c7ae7f4994c640f583">在选择了使用 <code class="notion-inline-code">Proxy</code> 代理来进行数据的操作拦截时，Vue 对依赖收集的逻辑也进行了修改，让我们分别来解析一下这两者的实现。</div><h4 class="notion-h notion-h3 notion-h-indent-1 notion-block-77648dddf66147ab873a5d581e510b7b" data-id="77648dddf66147ab873a5d581e510b7b"><span><div id="77648dddf66147ab873a5d581e510b7b" class="notion-header-anchor"></div><a class="notion-hash-link" href="#77648dddf66147ab873a5d581e510b7b" title="核心方法"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title"><b>核心方法</b></span></span></h4><div class="notion-text notion-block-a0961972e5724b51993957096fc5017d">Vue 提供了一下几个 <b>响应式数据声明</b> 的核心 API：</div><ul class="notion-list notion-list-disc notion-block-e3fded5ff245407d9076885dccdb7866"><li><code class="notion-inline-code">ref</code>：接受一个内部值，返回一个响应式的、可更改的 ref 对象，此对象只有一个指向其内部值的属性 <code class="notion-inline-code">.value</code>。<code class="notion-inline-code">function ref&lt;T&gt;(value: T): Ref&lt;UnwrapRef&lt;T&gt;&gt;</code><code class="notion-inline-code">interface Ref&lt;T&gt; {</code><code class="notion-inline-code"> value: T</code><code class="notion-inline-code">}</code></li></ul><ul class="notion-list notion-list-disc notion-block-3c60c6c53dcd477a886226cc321cceb8"><li><code class="notion-inline-code">shallowRef</code>：<code class="notion-inline-code">ref()</code> 的浅层作用形式。<code class="notion-inline-code">function shallowRef&lt;T&gt;(value: T): ShallowRef&lt;T&gt;</code><code class="notion-inline-code">interface ShallowRef&lt;T&gt; {</code><code class="notion-inline-code"> value: T</code><code class="notion-inline-code">}</code></li></ul><ul class="notion-list notion-list-disc notion-block-a589eab425c84d168cc767cde7759595"><li><code class="notion-inline-code">reactive</code>：返回一个对象的响应式代理。<code class="notion-inline-code">function reactive&lt;T extends object&gt;(target: T): UnwrapNestedRefs&lt;T&gt;</code></li></ul><ul class="notion-list notion-list-disc notion-block-a196d887e815415fb21b3fc9e47b3ac4"><li><code class="notion-inline-code">shallowReactive</code>：<code class="notion-inline-code">reactive()</code> 的浅层作用形式。<code class="notion-inline-code">function shallowReactive&lt;T extends object&gt;(target: T): T</code></li></ul><ul class="notion-list notion-list-disc notion-block-bfc0e175a2254a4d883b9086f8b063b9"><li><code class="notion-inline-code">readonly</code>：接受一个对象 (不论是响应式还是普通的) 或是一个 ref，返回一个原值的只读代理。<code class="notion-inline-code">function readonly&lt;T extends object&gt;(target: T): DeepReadonly&lt;UnwrapNestedRefs&lt;T&gt;&gt;</code></li></ul><ul class="notion-list notion-list-disc notion-block-28ff5797417148dabde7c64495c2a0f2"><li><code class="notion-inline-code">shallowReadonly</code>：<code class="notion-inline-code">readonly</code> 的浅层作用形式<code class="notion-inline-code">function shallowReadonly&lt;T extends object&gt;(target: T): Readonly&lt;T&gt;</code></li></ul><div class="notion-text notion-block-bdab8f4a35e04e9bb61a285cefe5e776">其中 <code class="notion-inline-code">ref</code> 虽然常常有文章说一般只用来 <b>声明基础数据的响应式</b>，但是其实 **所有的数据类型声明响应式时都可以使用 <code class="notion-inline-code">ref</code>**，只是内部为了同时实现基础数据的响应式处理，封装成了一个具有 <code class="notion-inline-code">value</code> 属性的对象，所以我们访问时必须通过 <code class="notion-inline-code">xxx.value</code> 的形式访问。</div><div class="notion-text notion-block-ef8ef2bd041e48be8a6b380a48063bdf"><code class="notion-inline-code">ref</code> 函数内部执行时会创建一个 <code class="notion-inline-code">RefImpl</code> 类型的实例，其中的 <code class="notion-inline-code">_value</code> 就保存响应式数据，并定义了对象的 <code class="notion-inline-code">get</code> 和 <code class="notion-inline-code">set</code> 方法，用来收集依赖和发布更新事件。如果不是 <code class="notion-inline-code">shallowRef</code> 声明的浅层响应式数据的话，其 <code class="notion-inline-code">_value</code> 其实也会通过 <code class="notion-inline-code">reactive</code> 方法进行深层数据处理。</div><div class="notion-text notion-block-ebbb20aae2e4415184d71e8e3429e009">而 <code class="notion-inline-code">reactive</code> 与 <code class="notion-inline-code">readonly</code> 则比较相似，都是通过 <code class="notion-inline-code">createReactiveObject</code> 方法来创建一个 <code class="notion-inline-code">Proxy</code> 对象返回，只是 <code class="notion-inline-code">readonly</code> 的 <code class="notion-inline-code">set</code> 和 <code class="notion-inline-code">deleteProperty</code> 操作会直接拦截报错，提示禁止更新。</div><div class="notion-text notion-block-9c874e54e6df4a108c19f98efa6109b6">至于 <code class="notion-inline-code">get</code> 操作的拦截两者的大体思路差不多，不过 <code class="notion-inline-code"><b>readonly</b></code><b> 因为只读的原因，数据不会发生改变，所以不会进行依赖收集操作</b>，如果有深层数据则会继续向内部进行同样的处理操作。</div><div class="notion-text notion-block-a37a9552fdd44194810b168cdbd28227">带有 <code class="notion-inline-code">shallow</code> 前缀的数据声明方法，结合官方的解释其实就明白了，整个定义 <b>类似深拷贝与浅拷贝的区别，即只处理首层数据</b>。代表假设使用 <code class="notion-inline-code">shadowRef</code>、<code class="notion-inline-code">shallowReactive</code> 声明的对象，如果对象的某个属性也是对象，则 <b>只有当这个属性的引用地址发生改变时才会触发更新</b>；至于 <code class="notion-inline-code">shallowReadobly</code> 的话，其实就是读取什么返回什么，基本没有别的处理了。</div><h4 class="notion-h notion-h3 notion-h-indent-1 notion-block-603772f2cd0c4335ab1c393d988138ce" data-id="603772f2cd0c4335ab1c393d988138ce"><span><div id="603772f2cd0c4335ab1c393d988138ce" class="notion-header-anchor"></div><a class="notion-hash-link" href="#603772f2cd0c4335ab1c393d988138ce" title="操作拦截"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title"><b>操作拦截</b></span></span></h4><div class="notion-text notion-block-f71789ba36f94c1fb899a90908899a5c">因为篇幅的问题，我们直接从核心方法 <code class="notion-inline-code">reactive</code> 开始。</div><div class="notion-text notion-block-bf2a2e3d2e624f01b871c6c239953f6a">当我们通过 <code class="notion-inline-code">reactive</code> 创建一个响应式数据时，会调用以下方法：</div><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">const reactiveMap = new WeakMap();
function reactive(target) {
  return createReactiveObject(target, false, mutableHandlers, mutableCollectionHandlers, reactiveMap);
}
function createReactiveObject(target, isReadonly, baseHandlers, collectionHandlers, proxyMap) {
  if (target[&quot;__v_raw&quot;] &amp;&amp; !(isReadonly &amp;&amp; target[&quot;__v_isReactive&quot;])) {
    return target;
  }
  const existingProxy = proxyMap.get(target);
  if (existingProxy) {
    return existingProxy;
  }
  const targetType = getTargetType(target);
  if (targetType === 0) { //基础类型数据
    return target;
  }
  const proxy = new Proxy(target, targetType === 2 ? collectionHandlers : baseHandlers);
  proxyMap.set(target, proxy);
  return proxy;
}</code></pre><blockquote class="notion-quote notion-block-c5c831ae995e4e0b84b257f38815b5c0"><div>省略了 readonly 判断和非引用数据判断。</div></blockquote><div class="notion-text notion-block-3f0b296c90ae49c38cb68700ac985198">在 <code class="notion-inline-code">createReactiveObject</code> 中首先判断了是否是 <b>保留原始数据</b> 和 只读数据校验，然后判断这个目标数据时候已经处理过，这两种情况都直接返回。</div><div class="notion-text notion-block-011d64d7d6ce442f9dbded92b182c6f0">然后通过 <code class="notion-inline-code">getTargetType</code> 判断数据类型：</div><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">function targetTypeMap(rawType) {
  switch (rawType) {
    case &quot;Object&quot;:
    case &quot;Array&quot;:
      return 1/* COMMON */;
    case &quot;Map&quot;:
    case &quot;Set&quot;:
    case &quot;WeakMap&quot;:
    case &quot;WeakSet&quot;:
      return 2/* COLLECTION */;
    default:
      return 0/* INVALID */;
  }
}</code></pre><div class="notion-text notion-block-ef0bfa14e0804340b69b8814a011ddcf">这里将数组和对象与 <code class="notion-inline-code">ES6</code> 新增的 <code class="notion-inline-code">Set、Map</code> 等进行了区分，非引用类型直接返回 <code class="notion-inline-code">invalid</code> 错误。</div><div class="notion-text notion-block-ae898c4c06b04f3a817c2a1ad3f6eb5f">最后则是根据数据类型选择合适的处理程序进行拦截定义。</div><div class="notion-text notion-block-e8404a451d1b4c75a33c527c71402052">这里我们假设是一个对象或者数组，此时 <code class="notion-inline-code">targetTypeMap</code> 函数返回 1，也就是使用上面定义的 <code class="notion-inline-code">mutableHandlers</code> 进行处理。</div><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">const mutableHandlers = {
  get: createGetter(),
  set: createSetter(),
  deleteProperty,
  has,
  ownKeys
};
function createGetter(isReadonly2 = false, shallow = false) {
  return function get(target, key, receiver) {
    if (key === &quot;__v_isReactive&quot;/* IS_REACTIVE */) {
      return !isReadonly2;
    } else if (key === &quot;__v_isReadonly&quot;/* IS_READONLY */) {
      return isReadonly2;
    } else if (key === &quot;__v_isShallow&quot;/* IS_SHALLOW */) {
      return shallow;
    } else if (key === &quot;__v_raw&quot;/* RAW */ &amp;&amp; receiver === (isReadonly2 ? shallow ? shallowReadonlyMap : readonlyMap : shallow ? shallowReactiveMap : reactiveMap).get(target)) {
      return target;
    }
    const targetIsArray = isArray(target);
    if (!isReadonly2 &amp;&amp; targetIsArray &amp;&amp; hasOwn(arrayInstrumentations, key)) {
      return Reflect.get(arrayInstrumentations, key, receiver);
    }
    const res = Reflect.get(target, key, receiver);
    if (isSymbol(key) ? builtInSymbols.has(key) : isNonTrackableKeys(key)) {
      return res;
    }
    if (!isReadonly2) {
      track(target, &quot;get&quot;/* GET */, key);
    }
    if (shallow) {
      return res;
    }
    if (isRef(res)) {
      return targetIsArray &amp;&amp; isIntegerKey(key) ? res : res.value;
    }
    if (isObject(res)) {
      return isReadonly2 ? readonly(res) : reactive(res);
    }
    return res;
  };
}
function has(target, key) {
  const result = Reflect.has(target, key);
  if (!isSymbol(key) || !builtInSymbols.has(key)) {
    track(target, &quot;has&quot;/* HAS */, key);
  }
  return result;
}
function ownKeys(target) {
  track(target, &quot;iterate&quot;/* ITERATE */, isArray(target) ? &quot;length&quot; : ITERATE_KEY);
  return Reflect.ownKeys(target);
}


function createSetter(shallow = false) {
  return function set(target, key, value, receiver) {
    let oldValue = target[key];
    if (isReadonly(oldValue) &amp;&amp; isRef(oldValue) &amp;&amp; !isRef(value)) {
      return false;
    }
    if (!shallow) {
      if (!isShallow(value) &amp;&amp; !isReadonly(value)) {
        oldValue = toRaw(oldValue);
        value = toRaw(value);
      }
      if (!isArray(target) &amp;&amp; isRef(oldValue) &amp;&amp; !isRef(value)) {
        oldValue.value = value;
        return true;
      }
    } else {
    }
    const hadKey = isArray(target) &amp;&amp; isIntegerKey(key) ? Number(key) &lt; target.length : hasOwn(target, key);
    const result = Reflect.set(target, key, value, receiver);
    if (target === toRaw(receiver)) {
      if (!hadKey) {
        trigger(target, &quot;add&quot;/* ADD */, key, value);
      } else if (hasChanged(value, oldValue)) {
        trigger(target, &quot;set&quot;/* SET */, key, value, oldValue);
      }
    }
    return result;
  };
}
function deleteProperty(target, key) {
  const hadKey = hasOwn(target, key);
  const oldValue = target[key];
  const result = Reflect.deleteProperty(target, key);
  if (result &amp;&amp; hadKey) {
    trigger(target, &quot;delete&quot;/* DELETE */, key, void 0, oldValue);
  }
  return result;
}</code></pre><div class="notion-text notion-block-7e1a01ae716e4ae4bbf075a96160df29">在 <code class="notion-inline-code">mutableHandlers</code> 定义了 <code class="notion-inline-code">get, set, deleteProperty, has, ownKeys</code> 五个方法的拦截操作，其中 <code class="notion-inline-code">set、deleteProperty</code> 属于数据修改操作，会改变原有数据，所以在这两个方法中 <b>主要进行“更新消息派发”，也就是 </b><code class="notion-inline-code"><b>trigger</b></code><b> 方法</b>，而剩下的 <code class="notion-inline-code">get、has、ownKeys</code> 三个方法则只会访问数据的值，不改变原数据，所以这三个方法中 <b>主要进行“数据依赖收集”， 也就是 </b><code class="notion-inline-code"><b>track</b></code><b> 方法</b>。</div><h4 class="notion-h notion-h3 notion-h-indent-1 notion-block-064e526a596c438180ffb604da2668b6" data-id="064e526a596c438180ffb604da2668b6"><span><div id="064e526a596c438180ffb604da2668b6" class="notion-header-anchor"></div><a class="notion-hash-link" href="#064e526a596c438180ffb604da2668b6" title="依赖收集"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title"><b>依赖收集</b></span></span></h4><div class="notion-text notion-block-00655ba5f50b4bcb9e016115d4a75a00">在数据读取和更新时定义好了依赖收集和更新派发事件的执行时机之后，我们再回头看一下 Vue 3 的依赖收集系统。</div><blockquote class="notion-quote notion-block-8f3e14e258dd4f6e835c50f0138d4167"><div>通过上文我们也知道在 Vue 2 中是给每个对象增加一个 Dep 实例来保存每个对象所关联的 Watcher 数组，然后更新时遍历执行，那么 Vue 3 是不是也是这么操作的呢？</div></blockquote><div class="notion-text notion-block-8b4ab2438af841868f3824985adc5b9f">答案是没有的。</div><div class="notion-text notion-block-c896fe044f6f46dc96bb23c5c46cad41">因为 Vue 3 采用的 <code class="notion-inline-code">Proxy</code> 可以直接拦截对象的访问和更新，而无需像 <code class="notion-inline-code">Object.defineProperty</code> 一样单独为每个属性定义拦截，所以 <b>一个引用类型数据我们只需要收集一个依赖即可，通过一个全局变量进行所有的依赖数据的依赖管理</b>。</div><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-plain text">const targetMap = new WeakMap();
let shouldTrack = true;
let activeEffect = null;

function track(target, type, key) {
  if (shouldTrack &amp;&amp; activeEffect) {
    let depsMap = targetMap.get(target)
    if (!depsMap) targetMap.set(target, (depsMap = new Map()))
    let dep = depsMap.get(key)
    if (!dep) depsMap.set(key, (dep = createDep()))
    const eventInfo = { effect: activeEffect, target, type, key }
    trackEffects(dep, eventInfo)
  }
}
function trackEffects(dep, debuggerEventExtraInfo) {
  let shouldTrack2 = false;
  if (effectTrackDepth &lt;= maxMarkerBits) {
    if (!newTracked(dep)) {
      dep.n |= trackOpBit;
      shouldTrack2 = !wasTracked(dep);
    }
  } else {
    shouldTrack2 = !dep.has(activeEffect);
  }
  if (shouldTrack) {
    dep.add(activeEffect)
    activeEffect.deps.push(dep)
  }
}</code></pre><blockquote class="notion-quote notion-block-1971e3f96d2442bfa0304e690b25e49b"><div>以上代码就是依赖收集部分的大致逻辑，通过 track 函数，在 shouldTrack 标识为 true 且存在激活副作用函数 activeEffect 时，会在 全局的依赖管理中心 targetMap 中插入该数据，并为该数据添加一个 Set 格式的 dep 依赖，将激活状态的副作用 activeEffect 插入到 dep 中</div></blockquote><div class="notion-text notion-block-84b6cefa2af7426b86e08a5da254c32f">收集到的依赖内容如下：</div><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-de34e67399c04934a7ee430bd0f8cb10"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column"><img src="data:image/svg+xml,%3C%3Fxml version=&#x27;1.0&#x27; encoding=&#x27;UTF-8&#x27;%3F%3E%3Csvg width=&#x27;1px&#x27; height=&#x27;1px&#x27; viewBox=&#x27;0 0 1 1&#x27; version=&#x27;1.1&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; xmlns:xlink=&#x27;http://www.w3.org/1999/xlink&#x27;%3E%3Ctitle%3E%3C/title%3E%3Cg stroke=&#x27;none&#x27; stroke-width=&#x27;1&#x27; fill=&#x27;none&#x27; fill-rule=&#x27;evenodd&#x27; fill-opacity=&#x27;0&#x27;%3E%3Cg transform=&#x27;translate(-249.000000, -126.000000)&#x27; fill=&#x27;%23FFFFFF&#x27;%3E%3Crect x=&#x27;249&#x27; y=&#x27;126&#x27; width=&#x27;1&#x27; height=&#x27;1&#x27;%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E" alt="notion image" loading="lazy" decoding="async"/></div></figure><figure class="notion-asset-wrapper notion-asset-wrapper-image notion-block-e301b360b742425a80921eb2634cc742"><div style="position:relative;display:flex;justify-content:center;align-self:center;width:100%;max-width:100%;flex-direction:column;height:100%"><img style="object-fit:cover" src="https://www.notion.so/image/https%3A%2F%2Ffile.notion.so%2Ff%2Fs%2F685fa767-e023-4232-9d98-b75816e90460%2FUntitled.png%3Ftable%3Dblock%26id%3De301b360-b742-425a-8092-1eb2634cc742%26expirationTimestamp%3D1679021228475%26signature%3DJib12_D6x7Sepm2ZBpjfcoh58Mzw3Y3V6FVKzy_qrlc?table=block&amp;id=e301b360-b742-425a-8092-1eb2634cc742&amp;cache=v2" alt="notion image" loading="lazy" decoding="async"/></div></figure><h4 class="notion-h notion-h3 notion-h-indent-1 notion-block-47fd9a4c28c5459b898156f04430c329" data-id="47fd9a4c28c5459b898156f04430c329"><span><div id="47fd9a4c28c5459b898156f04430c329" class="notion-header-anchor"></div><a class="notion-hash-link" href="#47fd9a4c28c5459b898156f04430c329" title="副作用定义"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title"><b>副作用定义</b></span></span></h4><div class="notion-text notion-block-c99f832b1cd14a02b0032095ea803144">Vue 3 中的副作用函数称为 <code class="notion-inline-code">effect</code>，官方也提供了该函数的直接调用，在 <b>执行时能自动收集相关依赖</b>。其定义如下：</div><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">function effect(fn, options) {
  if (fn.effect) {
    fn = fn.effect.fn;
  }
  const _effect = new ReactiveEffect(fn);
  if (options) {
    extend(_effect, options);
    if (options.scope)
      recordEffectScope(_effect, options.scope);
  }
  if (!options || !options.lazy) {
    _effect.run();
  }
  const runner = _effect.run.bind(_effect);
  runner.effect = _effect;
  return runner;
}</code></pre><div class="notion-text notion-block-d14c5789d7cb4eddbcd8a45d08960d21">它的本质呢其实就是 <b>返回一个绑定了当前作用域并且在内部封装过其他操作的 </b><code class="notion-inline-code"><b>fn</b></code><b> 函数的新函数</b>（<code class="notion-inline-code">render</code> 最终也会封装成一个 副作用函数），<code class="notion-inline-code">effect</code> 函数内部的核心逻辑还是创建一个 <code class="notion-inline-code">ReactiveEffect</code> 实例。</div><div class="notion-text notion-block-a907020347e547c79854a2223f5586aa">那么我们接着进入 <code class="notion-inline-code">ReactiveEffect</code> 内部看看。</div><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">class ReactiveEffect {
    constructor(fn, scheduler) {
        this.fn = fn;
        this.scheduler = scheduler;
        this.active = true;
        this.deps = [];
    }
    run() {
        if (!this.active) {
            return this.fn();
        }
        shouldTrack = true;
        activeEffect = this;
        const result = this.fn();
        shouldTrack = false;
        activeEffect = undefined;
        return result;
    }
    stop() {
        if (this.active) {
            cleanupEffect(this);
            if (this.onStop) {
                this.onStop();
            }
            this.active = false;
        }
    }
}
function cleanupEffect(effect) {
    effect.deps.forEach((dep) =&gt; {
        dep.delete(effect);
    });
    effect.deps.length = 0;
}</code></pre><blockquote class="notion-quote notion-block-27cda12e75bf4d83af7d5f37be4dcd0f"><div>这里对部分代码进行了简化，保留了依赖收集和停止处理的相关逻辑。</div></blockquote><div class="notion-text notion-block-79d4cf9c42284c59b3a71c2bc198a551">在上文的 <code class="notion-inline-code">effect</code> 函数执行时，会调用 <code class="notion-inline-code">ReactiveEffect</code> 实例的 <code class="notion-inline-code">run</code> 方法，执行副作用定义的函数 <code class="notion-inline-code">fn</code> 并将当前的 <code class="notion-inline-code">activeEffect</code> 设置为该实例。</div><div class="notion-text notion-block-b913a7f9f4a647939f246b58e514a188"><code class="notion-inline-code">fn</code> 函数执行时，遇到定义的响应式变量就会触发相应的 <code class="notion-inline-code">get</code> 操作，此时就会将当前的副作用实例（也就是 <code class="notion-inline-code">ReactiveEffect</code> 实例）插入到该变量的 <code class="notion-inline-code">dep</code> 数据，完成依赖收集过程。</div><div class="notion-text notion-block-b7cb43e658cc4068b2b3f82cc552d1fb">并且 Vue 3 中的 <code class="notion-inline-code">ReactiveEffect</code> 提供了一个 <code class="notion-inline-code">stop</code> 方法，在调用时会清空该副作用相关的所有数据依赖，并且将 <code class="notion-inline-code">this.active</code> 设置为 <code class="notion-inline-code">false</code>，避免后续执行时的依赖收集。</div><h4 class="notion-h notion-h3 notion-h-indent-1 notion-block-66ed567f6e1048878048f3d2cf5e8413" data-id="66ed567f6e1048878048f3d2cf5e8413"><span><div id="66ed567f6e1048878048f3d2cf5e8413" class="notion-header-anchor"></div><a class="notion-hash-link" href="#66ed567f6e1048878048f3d2cf5e8413" title="派发更新"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title"><b>派发更新</b></span></span></h4><div class="notion-text notion-block-78a967e24859482389e1fa7a60d5ae62">当数据更新时，即触发 <code class="notion-inline-code">set、deleteProperty</code> 等拦截时，就需要触发相应的依赖函数执行（也就是视图更新、<code class="notion-inline-code">watch</code> 执行等），其核心就是 <b>遍历 </b><code class="notion-inline-code"><b>targetMap</b></code><b> 中该数据对应的 </b><code class="notion-inline-code"><b>dep</b></code><b> 中的每个副作用函数执行</b>。</div><div class="notion-text notion-block-2260b5c6c075496d98edf7e241ec4a92">大致代码如下：</div><pre class="notion-code"><div class="notion-code-copy"><div class="notion-code-copy-button"><svg fill="currentColor" viewBox="0 0 16 16" width="1em" version="1.1"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg></div></div><code class="language-javascript">function trigger(target, type, key, newValue, oldValue, oldTarget) {
  const depsMap = targetMap.get(target);
  if (!depsMap) return;
  let deps = [];
  if (type === &quot;clear&quot;) {
    deps = [...depsMap.values()];
  } else if (key === &quot;length&quot; &amp;&amp; isArray(target)) {
    depsMap.forEach((dep, key2) =&gt; ((key2 === &quot;length&quot; || key2 &gt;= newValue) &amp;&amp; deps.push(dep)));
  } else {
    if (key !== void 0) {
      deps.push(depsMap.get(key));
    }
  }
  const effects = [];
  for (const dep of deps) {
    dep &amp;&amp; effects.push(...dep);
  }
  triggerEffects(createDep(effects));
}

function triggerEffects(dep) {
  const effects = isArray(dep) ? dep : [...dep];
  for (const effect of effects) {
    triggerEffect(effect)
  }
}

function triggerEffect(effect) {
  if (effect !== activeEffect || effect.allowRecurse) {
    effect.scheduler ? effect.scheduler() : effect.run();
  }
}</code></pre><div class="notion-text notion-block-cce946fd9f984b279241fdd4664e2576">简单理解就是：</div><ol start="1" class="notion-list notion-list-numbered notion-block-851654865f6340da8d8edafc405ad42e"><li>通过 <code class="notion-inline-code">targetMap.get(target)</code> 获取到该数据对应的 <code class="notion-inline-code">depsMap</code> 依赖数据</li></ol><ol start="2" class="notion-list notion-list-numbered notion-block-3abda3b1fcfb48fcae722bfe4a4a8019"><li>在 <code class="notion-inline-code">deps</code> 数组中插入这个操作 <code class="notion-inline-code">key</code> 对应的副作用函数，也就是 <code class="notion-inline-code">deps.push(depsMap.get(key))</code></li></ol><ol start="3" class="notion-list notion-list-numbered notion-block-83826c6d09e74690846f13bb781d1da6"><li>通过 <code class="notion-inline-code">createDep</code> 去除重复 <code class="notion-inline-code">effect</code> 副作用，调用 <code class="notion-inline-code">triggerEffect</code></li></ol><ol start="4" class="notion-list notion-list-numbered notion-block-8e33a75ff7db4fdc8fd7bb91499c121a"><li>遍历 <code class="notion-inline-code">effects</code> 并执行副作用函数</li></ol><h3 class="notion-h notion-h2 notion-h-indent-0 notion-block-65079663dc844ad29cf7effcf55e5b87" data-id="65079663dc844ad29cf7effcf55e5b87"><span><div id="65079663dc844ad29cf7effcf55e5b87" class="notion-header-anchor"></div><a class="notion-hash-link" href="#65079663dc844ad29cf7effcf55e5b87" title="小结一下"><svg viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><span class="notion-h-title"><b>小结一下</b></span></span></h3><div class="notion-text notion-block-d8c6006d04974cc890091ea557f53aaf">对比起 Vue 2 通过 <code class="notion-inline-code">Object.defineProperty</code> 在数据定义时为指定具体属性添加 <code class="notion-inline-code">getter/setter</code> 拦截、为每个对象添加 <code class="notion-inline-code">deps</code> 依赖数组的响应式系统实现方式，Vue 3 采用 <code class="notion-inline-code">ES6</code> 的 <code class="notion-inline-code">Proxy</code> 结合 <code class="notion-inline-code">WeakMap、WeakSet</code> ，通过代理在运行时拦截对象的基本操作来收集依赖并全局管理，在性能上就得到了很大的提升，也为开发者带来了更好的开发体验。</div><div class="notion-text notion-block-398ff12898ad4e56867908eadc1449e7">并且通过全局的依赖管理模式，也让 Vue 3 的组合式 API 和 <code class="notion-inline-code">hooks</code> 开发模式得以实现，在进行大型项目开发时，公共逻辑拆分也会变得更加清晰。</div><div class="notion-blank notion-block-322ec9a833fb4f03850f79aca4c35c51"> </div></article><aside class="notion-aside"><div class="notion-aside-table-of-contents"><div class="notion-aside-table-of-contents-header">Table of Contents</div><nav class="notion-table-of-contents"><a href="#d7a8d1b075b44df28e4ffcc48a9952ab" class="notion-table-of-contents-item notion-table-of-contents-item-indent-level-0"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:0">前言</span></a><a href="#6cb2fb736c044151a2ad30575a860350" class="notion-table-of-contents-item notion-table-of-contents-item-indent-level-0"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:0">Vue 的响应式系统设计思路</span></a><a href="#13697af900984d938cc386d519acbadd" class="notion-table-of-contents-item notion-table-of-contents-item-indent-level-0"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:0">Vue 2 的响应式实现</span></a><a href="#cdd06622d853483aa4e9d8bb71c9c8f3" class="notion-table-of-contents-item notion-table-of-contents-item-indent-level-0"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:0">Vue 3 的响应式实现</span></a><a href="#7c5402b1b8db4670a0616def4dbf6db5" class="notion-table-of-contents-item notion-table-of-contents-item-indent-level-1"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:16px">什么是 Proxy ？</span></a><a href="#cf0ce65a09c5435eb1f1e111197a60e7" class="notion-table-of-contents-item notion-table-of-contents-item-indent-level-1"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:16px">响应式的实现</span></a><a href="#77648dddf66147ab873a5d581e510b7b" class="notion-table-of-contents-item notion-table-of-contents-item-indent-level-1"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:16px">核心方法</span></a><a href="#603772f2cd0c4335ab1c393d988138ce" class="notion-table-of-contents-item notion-table-of-contents-item-indent-level-1"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:16px">操作拦截</span></a><a href="#064e526a596c438180ffb604da2668b6" class="notion-table-of-contents-item notion-table-of-contents-item-indent-level-1"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:16px">依赖收集</span></a><a href="#47fd9a4c28c5459b898156f04430c329" class="notion-table-of-contents-item notion-table-of-contents-item-indent-level-1"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:16px">副作用定义</span></a><a href="#66ed567f6e1048878048f3d2cf5e8413" class="notion-table-of-contents-item notion-table-of-contents-item-indent-level-1"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:16px">派发更新</span></a><a href="#65079663dc844ad29cf7effcf55e5b87" class="notion-table-of-contents-item notion-table-of-contents-item-indent-level-0"><span class="notion-table-of-contents-item-body" style="display:inline-block;margin-left:0">小结一下</span></a></nav></div></aside></div></main><footer class="styles_footer__RBpyk"><div class="styles_copyright__nhL_k">Copyright 2022 <!-- -->over58</div><div class="styles_settings__GyEhi"></div><div class="styles_social__ptL3p"><a class="styles_github__0JN7a" href="https://github.com/over58" title="GitHub @over58" target="_blank" rel="noopener noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></div></footer></div></div></div><a href="https://github.com/over58?tab=repositories" target="_blank" rel="noopener noreferrer" class="styles_githubCorner__7QjNo" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#70B7FD;color:#fff;position:absolute;z-index:1001;top:0;right:0;border:0;transform:scale(1, 1)" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="styles_octoArm__PrtZ9"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor"></path></svg></a></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"site":{"domain":"https://www.notion.so/Blog-351abd6d2fa847608085f6e40a7a46cd?pvs=4","name":"博客空间","rootNotionPageId":"351abd6d2fa847608085f6e40a7a46cd","rootNotionSpaceId":null,"description":"Notion构建的博客空间测试"},"recordMap":{"block":{"b02d7c09-9db4-480c-8082-a3631db20f71":{"role":"comment_only","value":{"id":"b02d7c09-9db4-480c-8082-a3631db20f71","version":237,"type":"page","properties":{"QZ{H":[["Vue"]],"title":[["Vue2与Vue3响应式原理与依赖收集详解"]]},"content":["a7aa2ea3-9ff3-4b8d-972b-b222f2e122e7","6165f650-dbc2-47a2-a907-9037cc91d28d","4ce7dd07-f05b-4309-9202-4b6b07aa0472","5052ca8d-cc91-4969-845c-3abcafd8762d","d7a8d1b0-75b4-4df2-8e4f-fcc48a9952ab","7dfae6fc-7f4f-4c4b-b30e-b69e91d3a313","5056afeb-5ff0-43ab-87f5-124da178910f","84de292d-1192-41a8-9b3c-be868a516b3d","6cb2fb73-6c04-4151-a2ad-30575a860350","43dce486-a728-47f2-a776-c7d833534c63","6903797f-7af0-4048-b646-84cccfa9ec30","c600905e-d505-47d4-8eb9-dbe537f0e982","6a3f2215-7667-49a0-a68b-d17218e4acff","a0841ad4-e670-4878-9d45-a19264d6d124","40a42371-6bf4-4733-b6f5-5f4f535c2b2c","dfed423a-4118-4cdf-8aea-8d74aa7006b9","369c4133-084f-41ba-a624-0bcff47f8fcc","44498052-9285-4573-af1a-080751d901cf","13697af9-0098-4d93-8cc3-86d519acbadd","c6c21a4b-f7e3-4e7e-8ded-d18c0ddcf7b5","67210637-d52f-4083-b4d9-ce9f34a25af0","5b66acc4-c46e-4afc-b09c-9e05919d0881","226e1b9f-574f-46af-a42b-af3811200a47","3fab77db-abc6-49ae-ab59-3850c9947feb","113f7e96-0241-4ca3-b331-15f97c0ab639","b42d2e60-93ba-4866-b360-79a065b66d69","6ad5b0bc-1d9c-4f9e-9087-fdb170fff6d4","0319d0bf-1ad6-49b8-aac8-3e4f1a352393","9de28176-0100-49a4-9e37-c965dcf7f332","66085b49-5f84-42a6-be59-bf37d2fa569d","18af2355-20ee-4312-95f4-450ee4148b55","500117a3-be90-4f77-8daa-302b170453a6","e1cc7f78-1204-4fc5-bf0e-60e0417ea4c3","cdd06622-d853-483a-a4e9-d8bb71c9c8f3","11d62ff4-9d1b-4049-be7c-217cab0f01ba","7c5402b1-b8db-4670-a061-6def4dbf6db5","ce48ddc6-adda-484a-8ab3-3628a4f29b78","afa8f16d-b9a6-47b6-90ab-0dc5a2655a80","ebbc3278-a80d-4f60-95fe-beb4c024081e","5f339f57-7b82-499e-bf69-8e2b660092f9","341baaef-44ff-4505-8b33-d8368fbf21d6","b8d54078-14b5-4aac-891b-9fb1fa130994","affa42e3-1521-4eff-b7a3-3d9cda7f6658","e59eb071-9aed-441e-af7a-13f497f8297a","e1443c27-ea1a-4ab6-9a2d-cb1923895d86","0c4d5904-39cf-4d2d-b016-9a70bc099ddb","7c9c0e16-d453-4c59-bc94-da17d8c419bf","f12643b0-c521-43ed-a83e-e094d821e428","8c4d25df-b13e-4853-90de-a0e1334f25bb","4071f8a5-a261-4feb-bffb-0130ace83fa1","186444d7-d443-4647-b879-18f7a7585d2f","0b0a3e42-c951-4f8a-8217-5174a7c5cc89","6ed7f0bf-3bb7-49fe-9134-ad6c1c10e994","0d0f973a-d513-4743-9a71-6da53f32a6a2","2ed16b7e-6164-456a-b9a2-d27a73696460","0ccdb098-b4fb-4822-b57a-98f495927a81","a6af6927-0fb5-4a28-b65e-5dfd0b8b7bec","5375187d-13cb-4354-8d46-78bfe3055dd9","52db9a96-7e89-4a5d-812b-e7dfc8f5f76c","5b789732-1338-4ced-8d14-261f48271f62","f428a7de-1d49-414f-b304-9db35ad4a5ea","af02b798-549a-43f6-aa84-c3abc976de48","cf0ce65a-09c5-435e-b1f1-e111197a60e7","a78532a0-bd6a-40c7-ae7f-4994c640f583","77648ddd-f661-47ab-873a-5d581e510b7b","a0961972-e572-4b51-9939-57096fc5017d","e3fded5f-f245-407d-9076-885dccdb7866","3c60c6c5-3dcd-477a-8862-26cc321cceb8","a589eab4-25c8-4d16-8cc7-67cde7759595","a196d887-e815-415f-b21b-3fc9e47b3ac4","bfc0e175-a225-4a4d-883b-9086f8b063b9","28ff5797-4171-48da-bde7-c64495c2a0f2","bdab8f4a-35e0-4e9b-b61a-285cefe5e776","ef8ef2bd-041e-48be-8a6b-380a48063bdf","ebbb20aa-e2e4-4151-84d7-1e8e3429e009","9c874e54-e6df-4a10-8c19-f98efa6109b6","a37a9552-fdd4-4194-810b-168cdbd28227","603772f2-cd0c-4335-ab1c-393d988138ce","f71789ba-36f9-4c1f-b899-a90908899a5c","bf2a2e3d-2e62-4f01-b871-c6c239953f6a","49d9cc2d-ba2c-4578-a58b-898dbefa63eb","c5c831ae-995e-4e0b-84b2-57f38815b5c0","3f0b296c-90ae-49c3-8cb6-8700ac985198","011d64d7-d6ce-442f-9dbd-ed92b182c6f0","22a3995e-ebff-4b74-a8ed-b3f94904d2bb","ef0bfa14-e080-4340-b69b-8814a011ddcf","ae898c4c-06b0-4f3a-817c-2a1ad3f6eb5f","e8404a45-1d1b-4c75-a33c-527c71402052","e120dcfe-8932-4d55-8ef2-0d20d82ba130","7e1a01ae-716e-4ae4-bbf0-75a96160df29","064e526a-596c-4381-80ff-b604da2668b6","00655ba5-f50b-4bcb-9e01-6115d4a75a00","8f3e14e2-58dd-4f6e-835c-50f0138d4167","8b4ab243-8af8-4186-8f38-24985adc5b9f","c896fe04-4f6f-46dc-96bb-23c5c46cad41","6309ceda-7033-4bc2-8f71-e2a76acdb77c","1971e3f9-6d24-42bf-a030-4e690b25e49b","84b6cefa-2af7-426b-86e0-8a5da254c32f","de34e673-99c0-4934-a7ee-430bd0f8cb10","e301b360-b742-425a-8092-1eb2634cc742","47fd9a4c-28c5-459b-8981-56f04430c329","c99f832b-1cd1-4a02-b003-2095ea803144","8d53c050-33b5-4156-a051-99480110a0dc","d14c5789-d7cb-4edd-bcd8-a45d08960d21","a9070203-47e5-47c7-9854-a2223f5586aa","4f88acee-088c-491c-ab8c-3e082a0e93c3","27cda12e-75bf-4d83-af7d-5f37be4dcd0f","79d4cf9c-4228-4c59-b3a7-1c2bc198a551","b913a7f9-f4a6-4793-9f24-6b58e514a188","b7cb43e6-58cc-4068-b2b3-f82cc552d1fb","66ed567f-6e10-4887-8048-f3d2cf5e8413","78a967e2-4859-4823-89e1-fa7a60d5ae62","2260b5c6-c075-496d-98ed-f7e241ec4a92","87ad0d0b-05fa-465f-8aad-0148a57d210d","cce946fd-9f98-4b27-9241-fdd4664e2576","85165486-5f63-40da-8d8e-dafc405ad42e","3abda3b1-fcfb-48fc-ae72-2bfe4a4a8019","83826c6d-09e7-4690-846f-13bb781d1da6","8e33a75f-f7db-4fdc-8fd7-bb91499c121a","65079663-dc84-4ad2-9cf7-effcf55e5b87","d8c6006d-0497-4cc8-9009-1ea557f53aaf","398ff128-98ad-4e56-8679-08eadc1449e7","322ec9a8-33fb-4f03-850f-79aca4c35c51"],"format":{"page_full_width":false},"created_time":1678246194155,"last_edited_time":1678277328248,"parent_id":"41b2dc5d-80f3-41b0-8de7-04219fb08277","parent_table":"collection","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"d1d5df90-9871-450b-9aa0-5b65b0c967fc":{"role":"comment_only","value":{"id":"d1d5df90-9871-450b-9aa0-5b65b0c967fc","version":115,"type":"collection_view","view_ids":["56c062c2-e19b-4f5b-9075-3b233d1067e5"],"collection_id":"41b2dc5d-80f3-41b0-8de7-04219fb08277","format":{"collection_pointer":{"id":"41b2dc5d-80f3-41b0-8de7-04219fb08277","table":"collection","spaceId":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"created_time":1678274273443,"last_edited_time":1678793295145,"parent_id":"351abd6d-2fa8-4760-8085-f6e40a7a46cd","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"351abd6d-2fa8-4760-8085-f6e40a7a46cd":{"role":"comment_only","value":{"id":"351abd6d-2fa8-4760-8085-f6e40a7a46cd","version":181,"type":"page","properties":{"title":[["Blog"]]},"content":["bc21ff77-2284-43c5-a269-a8a0a462ea8d","d1d5df90-9871-450b-9aa0-5b65b0c967fc","3cf0c445-fedb-4ee4-bcb1-f66a41a53ae3","a84ecc0f-98cf-4279-b789-3bda6892f4e4"],"format":{"page_icon":"🍊","page_full_width":false,"copied_from_pointer":{"id":"4cd0eced-e273-46c2-84f5-a7efd7fbdd2f","table":"block","spaceId":"1f88cc90-92fd-4ce4-bfcd-25daec2ffbbe"},"page_cover_position":0.6},"permissions":[{"role":"comment_only","type":"public_permission","added_timestamp":1678277118866,"allow_search_engine_indexing":true}],"created_time":1678273330850,"last_edited_time":1678808908253,"parent_id":"6213d7fa-69ee-4428-b632-ddc81a3ae5e7","parent_table":"team","alive":true,"copied_from":"4cd0eced-e273-46c2-84f5-a7efd7fbdd2f","created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"a7aa2ea3-9ff3-4b8d-972b-b222f2e122e7":{"role":"comment_only","value":{"id":"a7aa2ea3-9ff3-4b8d-972b-b222f2e122e7","version":6,"type":"text","created_time":1678246326006,"last_edited_time":1678246327442,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"6165f650-dbc2-47a2-a907-9037cc91d28d":{"role":"comment_only","value":{"id":"6165f650-dbc2-47a2-a907-9037cc91d28d","version":2,"type":"text","properties":{"title":[["高级前端进阶 "],[" "],["2023-03-02 09:10",[["i"]]],[" "],["发表于浙江",[["i"]]]]},"created_time":1678246197698,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"4ce7dd07-f05b-4309-9202-4b6b07aa0472":{"role":"comment_only","value":{"id":"4ce7dd07-f05b-4309-9202-4b6b07aa0472","version":2,"type":"text","properties":{"title":[["以下文章来源于MiyueFE 的前端圈 ，作者MiyueFE"]]},"created_time":1678246197698,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"5052ca8d-cc91-4969-845c-3abcafd8762d":{"role":"comment_only","value":{"id":"5052ca8d-cc91-4969-845c-3abcafd8762d","version":2,"type":"text","properties":{"title":[["MiyueFE 的前端圈",[["b"],["a","https://mp.weixin.qq.com/s?__biz=MzA4Nzg0MDM5Nw==\u0026mid=2247516897\u0026idx=1\u0026sn=f39eea5519e5030e4f90486730f32289\u0026key=bd40c5f4b2f52e015c023b573b440be2611c95b6f4e4ff73d4d308edfcab7bdd32185beaf2045478e8c09f306834e33b4ee0aff2f9953779e401c747efc49833da285854e36964499cd40005c692976d2b33801c7fefaa1af4e7e101586aab72dc47eed826a7884e71774a2cd23339366742a568a9530a4af211050c8443cda3\u0026ascene=0\u0026uin=MTUyNzU1NTAyOA%3D%3D\u0026devicetype=iMac+MacBookPro16%2C1+OSX+OSX+13.2.1+build(22D68)\u0026version=13070011\u0026nettype=WIFI\u0026lang=zh_CN\u0026countrycode=CN\u0026fontScale=100\u0026exportkey=n_ChQIAhIQNl04xcbdhvzYP8Cm%2FWTYaBKCAgIE97dBBAEAAAAAANOhCUFZkAYAAAAOpnltbLcz9gKNyK89dVj0yQwAQSvAeYLgD6lUF87Gn%2FYvy%2FlkznY41ltqTXmTcvYycABnlRU5yN568IcySNcbMFHD8DDTfY75tSwTR7KCabvD5cqG1InNnEmI9eIbDmn7YWRtkh%2B1qC%2BybZLq%2F2VEbcN0XWbyrzOJmVNpHMvtIt8XqZOUPgvaZKknK3SV3sXunBw4BPFzBUtdA15QQ7BV%2BfphAUipFeWGvaFEwbBHRxYK01ByGfL%2FkUOcexALRD%2FKvr6%2FHr3lp5iaTjVYC4U91bcAOrZhclTl4GtF8vaCfPkN1aPH%2FfcxqSErVw%3D%3D\u0026acctmode=0\u0026pass_ticket=29C%2BK84WJDGNWmYYkoIQMVRxwYOX0zfGMDCklz%2Fo9OkGjIHzMX2xSMzCRttDah%2F64apwTp36IeCaPDtuEOSl4g%3D%3D\u0026wx_header=0#"]]],[".",[["a","https://mp.weixin.qq.com/s?__biz=MzA4Nzg0MDM5Nw==\u0026mid=2247516897\u0026idx=1\u0026sn=f39eea5519e5030e4f90486730f32289\u0026key=bd40c5f4b2f52e015c023b573b440be2611c95b6f4e4ff73d4d308edfcab7bdd32185beaf2045478e8c09f306834e33b4ee0aff2f9953779e401c747efc49833da285854e36964499cd40005c692976d2b33801c7fefaa1af4e7e101586aab72dc47eed826a7884e71774a2cd23339366742a568a9530a4af211050c8443cda3\u0026ascene=0\u0026uin=MTUyNzU1NTAyOA%3D%3D\u0026devicetype=iMac+MacBookPro16%2C1+OSX+OSX+13.2.1+build(22D68)\u0026version=13070011\u0026nettype=WIFI\u0026lang=zh_CN\u0026countrycode=CN\u0026fontScale=100\u0026exportkey=n_ChQIAhIQNl04xcbdhvzYP8Cm%2FWTYaBKCAgIE97dBBAEAAAAAANOhCUFZkAYAAAAOpnltbLcz9gKNyK89dVj0yQwAQSvAeYLgD6lUF87Gn%2FYvy%2FlkznY41ltqTXmTcvYycABnlRU5yN568IcySNcbMFHD8DDTfY75tSwTR7KCabvD5cqG1InNnEmI9eIbDmn7YWRtkh%2B1qC%2BybZLq%2F2VEbcN0XWbyrzOJmVNpHMvtIt8XqZOUPgvaZKknK3SV3sXunBw4BPFzBUtdA15QQ7BV%2BfphAUipFeWGvaFEwbBHRxYK01ByGfL%2FkUOcexALRD%2FKvr6%2FHr3lp5iaTjVYC4U91bcAOrZhclTl4GtF8vaCfPkN1aPH%2FfcxqSErVw%3D%3D\u0026acctmode=0\u0026pass_ticket=29C%2BK84WJDGNWmYYkoIQMVRxwYOX0zfGMDCklz%2Fo9OkGjIHzMX2xSMzCRttDah%2F64apwTp36IeCaPDtuEOSl4g%3D%3D\u0026wx_header=0#"]]],["\n",[["a","https://mp.weixin.qq.com/s?__biz=MzA4Nzg0MDM5Nw==\u0026mid=2247516897\u0026idx=1\u0026sn=f39eea5519e5030e4f90486730f32289\u0026key=bd40c5f4b2f52e015c023b573b440be2611c95b6f4e4ff73d4d308edfcab7bdd32185beaf2045478e8c09f306834e33b4ee0aff2f9953779e401c747efc49833da285854e36964499cd40005c692976d2b33801c7fefaa1af4e7e101586aab72dc47eed826a7884e71774a2cd23339366742a568a9530a4af211050c8443cda3\u0026ascene=0\u0026uin=MTUyNzU1NTAyOA%3D%3D\u0026devicetype=iMac+MacBookPro16%2C1+OSX+OSX+13.2.1+build(22D68)\u0026version=13070011\u0026nettype=WIFI\u0026lang=zh_CN\u0026countrycode=CN\u0026fontScale=100\u0026exportkey=n_ChQIAhIQNl04xcbdhvzYP8Cm%2FWTYaBKCAgIE97dBBAEAAAAAANOhCUFZkAYAAAAOpnltbLcz9gKNyK89dVj0yQwAQSvAeYLgD6lUF87Gn%2FYvy%2FlkznY41ltqTXmTcvYycABnlRU5yN568IcySNcbMFHD8DDTfY75tSwTR7KCabvD5cqG1InNnEmI9eIbDmn7YWRtkh%2B1qC%2BybZLq%2F2VEbcN0XWbyrzOJmVNpHMvtIt8XqZOUPgvaZKknK3SV3sXunBw4BPFzBUtdA15QQ7BV%2BfphAUipFeWGvaFEwbBHRxYK01ByGfL%2FkUOcexALRD%2FKvr6%2FHr3lp5iaTjVYC4U91bcAOrZhclTl4GtF8vaCfPkN1aPH%2FfcxqSErVw%3D%3D\u0026acctmode=0\u0026pass_ticket=29C%2BK84WJDGNWmYYkoIQMVRxwYOX0zfGMDCklz%2Fo9OkGjIHzMX2xSMzCRttDah%2F64apwTp36IeCaPDtuEOSl4g%3D%3D\u0026wx_header=0#"]]],["专注前端学习，从入门到养生，主要分享个人在前端学习中遇见的好文章以及个人理解，文笔不好，还请大家谅解。",[["a","https://mp.weixin.qq.com/s?__biz=MzA4Nzg0MDM5Nw==\u0026mid=2247516897\u0026idx=1\u0026sn=f39eea5519e5030e4f90486730f32289\u0026key=bd40c5f4b2f52e015c023b573b440be2611c95b6f4e4ff73d4d308edfcab7bdd32185beaf2045478e8c09f306834e33b4ee0aff2f9953779e401c747efc49833da285854e36964499cd40005c692976d2b33801c7fefaa1af4e7e101586aab72dc47eed826a7884e71774a2cd23339366742a568a9530a4af211050c8443cda3\u0026ascene=0\u0026uin=MTUyNzU1NTAyOA%3D%3D\u0026devicetype=iMac+MacBookPro16%2C1+OSX+OSX+13.2.1+build(22D68)\u0026version=13070011\u0026nettype=WIFI\u0026lang=zh_CN\u0026countrycode=CN\u0026fontScale=100\u0026exportkey=n_ChQIAhIQNl04xcbdhvzYP8Cm%2FWTYaBKCAgIE97dBBAEAAAAAANOhCUFZkAYAAAAOpnltbLcz9gKNyK89dVj0yQwAQSvAeYLgD6lUF87Gn%2FYvy%2FlkznY41ltqTXmTcvYycABnlRU5yN568IcySNcbMFHD8DDTfY75tSwTR7KCabvD5cqG1InNnEmI9eIbDmn7YWRtkh%2B1qC%2BybZLq%2F2VEbcN0XWbyrzOJmVNpHMvtIt8XqZOUPgvaZKknK3SV3sXunBw4BPFzBUtdA15QQ7BV%2BfphAUipFeWGvaFEwbBHRxYK01ByGfL%2FkUOcexALRD%2FKvr6%2FHr3lp5iaTjVYC4U91bcAOrZhclTl4GtF8vaCfPkN1aPH%2FfcxqSErVw%3D%3D\u0026acctmode=0\u0026pass_ticket=29C%2BK84WJDGNWmYYkoIQMVRxwYOX0zfGMDCklz%2Fo9OkGjIHzMX2xSMzCRttDah%2F64apwTp36IeCaPDtuEOSl4g%3D%3D\u0026wx_header=0#"]]]]},"created_time":1678246197698,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"d7a8d1b0-75b4-4df2-8e4f-fcc48a9952ab":{"role":"comment_only","value":{"id":"d7a8d1b0-75b4-4df2-8e4f-fcc48a9952ab","version":2,"type":"sub_header","properties":{"title":[["前言",[["b"]]]]},"created_time":1678246197704,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"7dfae6fc-7f4f-4c4b-b30e-b69e91d3a313":{"role":"comment_only","value":{"id":"7dfae6fc-7f4f-4c4b-b30e-b69e91d3a313","version":2,"type":"text","properties":{"title":[["继 Angular 和 React 之后，尤大在 2016 年发布了如今“前端三剑客”之一的 Vue 2.0，并凭借其简单易用、轻量高效的特点受到了广泛的欢迎，特别是在国内环境中。然而 Vue 2 中基于 "],["Object.defineProperty",[["c"]]],[" 实现的响应式系统，随着 JavaScript 与浏览器技术的不断升级，其缺陷也愈加明显~"]]},"created_time":1678246197704,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"5056afeb-5ff0-43ab-87f5-124da178910f":{"role":"comment_only","value":{"id":"5056afeb-5ff0-43ab-87f5-124da178910f","version":2,"type":"text","properties":{"title":[["所以 Vue 团队在 Vue 2 的基础上，通过基于 "],["Proxy",[["c"]]],[" 的全新响应式系统发布了 Vue 3.0，带来了更好的性能表现。"]]},"created_time":1678246197704,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"84de292d-1192-41a8-9b3c-be868a516b3d":{"role":"comment_only","value":{"id":"84de292d-1192-41a8-9b3c-be868a516b3d","version":2,"type":"text","properties":{"title":[["本文将深入剖析 Vue 2 与 Vue 3 的响应式系统实现，解释其实现原理和优势对比，如果你正在学习和了解 Vue 源码相关的内容，那本文肯定值得一看~"]]},"created_time":1678246197704,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"6cb2fb73-6c04-4151-a2ad-30575a860350":{"role":"comment_only","value":{"id":"6cb2fb73-6c04-4151-a2ad-30575a860350","version":2,"type":"sub_header","properties":{"title":[["Vue 的响应式系统设计思路",[["b"]]]]},"created_time":1678246197705,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"43dce486-a728-47f2-a776-c7d833534c63":{"role":"comment_only","value":{"id":"43dce486-a728-47f2-a776-c7d833534c63","version":2,"type":"text","properties":{"title":[["虽然 Vue 2 与 Vue 3 实现响应式系统的方式不同，但是他们的核心思想还是一致的，都是通过 "],["发布-订阅模式",[["b"]]],[" 来实现（因为发布者和观察者之间多了一个 "],["dependence",[["b"]]],[" 依赖收集者，与传统观察者模式不同）。"]]},"created_time":1678246197705,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"6903797f-7af0-4048-b646-84cccfa9ec30":{"role":"comment_only","value":{"id":"6903797f-7af0-4048-b646-84cccfa9ec30","version":2,"type":"quote","properties":{"title":[["个人理解，观察者模式 与 发布-订阅模式 都是 消息传递的一种实现方式，用来实现 对象间的通信（消息传递），只是发布订阅模式可以看做是观察者模式的 升级版，避免了 被观察对象与观察者之间的直接联系。"]]},"created_time":1678246197705,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"c600905e-d505-47d4-8eb9-dbe537f0e982":{"role":"comment_only","value":{"id":"c600905e-d505-47d4-8eb9-dbe537f0e982","version":2,"type":"text","properties":{"title":[["观察者模式：一个被观察对象对应多个观察者，两者直接联系；被观察这改变时直接向所有观察者发送消息（调用观察者的更新方法）"]]},"created_time":1678246197705,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"6a3f2215-7667-49a0-a68b-d17218e4acff":{"role":"comment_only","value":{"id":"6a3f2215-7667-49a0-a68b-d17218e4acff","version":2,"type":"image","properties":{"source":[["https://mmbiz.qpic.cn/mmbiz_png/pman3QtrTawViclZEmHCpYTwM69daBBiaoGRGpqibW0KVxLI9vVhjJpnGxrpiaf5LxxaehyweiarUlPedNCKLvCkTpw/640?wx_fmt=png\u0026wxfrom=5\u0026wx_lazy=1\u0026wx_co=1"]]},"created_time":1678246197705,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"a0841ad4-e670-4878-9d45-a19264d6d124":{"role":"comment_only","value":{"id":"a0841ad4-e670-4878-9d45-a19264d6d124","version":2,"type":"text","properties":{"title":[["image-20230220161149634.png"]]},"created_time":1678246197706,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"40a42371-6bf4-4733-b6f5-5f4f535c2b2c":{"role":"comment_only","value":{"id":"40a42371-6bf4-4733-b6f5-5f4f535c2b2c","version":4,"type":"text","properties":{"title":[["发布订阅模式：被观察对象与观察者之间可能是 "],["多对多",[["b"]]],[" 的关系，两者都可以绑定多个另一角色；而两个角色之间还有一个 "],["依赖收集和管理",[["b"]]],[" 的角色（提供一些观察者的操作方法）。"]]},"created_time":1678246197706,"last_edited_time":1678255678877,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"dfed423a-4118-4cdf-8aea-8d74aa7006b9":{"role":"comment_only","value":{"id":"dfed423a-4118-4cdf-8aea-8d74aa7006b9","version":2,"type":"image","properties":{"source":[["https://mmbiz.qpic.cn/mmbiz_png/pman3QtrTawViclZEmHCpYTwM69daBBiaob6eth9iaNXTgtPH4jIESUUNeRJta6g2mOXLjzMOCdqK6uEhMNZgP0xQ/640?wx_fmt=png\u0026wxfrom=5\u0026wx_lazy=1\u0026wx_co=1"]]},"created_time":1678246197706,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"369c4133-084f-41ba-a624-0bcff47f8fcc":{"role":"comment_only","value":{"id":"369c4133-084f-41ba-a624-0bcff47f8fcc","version":2,"type":"quote","properties":{"title":[["在 Vue 中我们视图中依赖的每一个数据其实就是一个被观察者，我们的视图渲染函数（renderWatcher）和其他的 watcher/effect 函数则都是订阅者。"]]},"created_time":1678246197706,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"44498052-9285-4573-af1a-080751d901cf":{"role":"comment_only","value":{"id":"44498052-9285-4573-af1a-080751d901cf","version":2,"type":"text","properties":{"title":[["当数据改变时，就会发送一个事件去触发我们的观察者进行更新，即视图更新。"]]},"created_time":1678246197706,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"13697af9-0098-4d93-8cc3-86d519acbadd":{"role":"comment_only","value":{"id":"13697af9-0098-4d93-8cc3-86d519acbadd","version":2,"type":"sub_header","properties":{"title":[["Vue 2 的响应式实现",[["b"]]]]},"created_time":1678246197707,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"c6c21a4b-f7e3-4e7e-8ded-d18c0ddcf7b5":{"role":"comment_only","value":{"id":"c6c21a4b-f7e3-4e7e-8ded-d18c0ddcf7b5","version":2,"type":"text","properties":{"title":[["刚刚我们简述了一下 Vue 实现响应式的基础方案，就是通过发布订阅模式收集数据依赖，当数据更新时触发 render 等一系列 Watcher 函数的执行来实现视图更新的。"]]},"created_time":1678246197707,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"67210637-d52f-4083-b4d9-ce9f34a25af0":{"role":"comment_only","value":{"id":"67210637-d52f-4083-b4d9-ce9f34a25af0","version":2,"type":"text","properties":{"title":[["大家也都知道 Vue 2 是通过 "],["Object.defineProperty",[["c"]]],[" 来实现数据 "],["读取和更新时的操作劫持",[["b"]]],["，通过更改默认的 "],["getter/setter",[["b"]]],[" 函数，在 "],["get",[["b"]]],[" 过程中收集依赖，在 "],["set",[["b"]]],[" 过程中派发更新的。"]]},"created_time":1678246197707,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"5b66acc4-c46e-4afc-b09c-9e05919d0881":{"role":"comment_only","value":{"id":"5b66acc4-c46e-4afc-b09c-9e05919d0881","version":2,"type":"text","properties":{"title":[["我们可以通过下面的简易代码来分析："]]},"created_time":1678246197707,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"226e1b9f-574f-46af-a42b-af3811200a47":{"role":"comment_only","value":{"id":"226e1b9f-574f-46af-a42b-af3811200a47","version":104,"type":"code","properties":{"title":[["// 响应式数据处理，构造一个响应式对象\nclass Observer {\n  constructor(data) {\n    this.data = data\n    this.walk(data)\n  }\n\n// 遍历对象的每个 已定义 属性，分别执行 defineReactive\n  walk(data) {\n    if (!data || typeof data !== 'object') {\n      return\n    }\n\n    Object.keys(data).forEach(key =\u003e {\n      this.defineReactive(data, key, data[key])\n    })\n  }\n\n// 为对象的每个属性重新设置 getter/setter\n  defineReactive(obj, key, val) {\n// 每个属性都有单独的 dep 依赖管理\n    const dep = new Dep()\n\n// 通过 defineProperty 进行操作代理定义\n    Object.defineProperty(obj, key, {\n      enumerable: true,\n      configurable: true,\n// 值的读取操作，进行依赖收集\n      get() {\n        if (Dep.target) {\n          dep.depend()\n        }\n        return val\n      },\n// 值的更新操作，触发依赖更新\n      set(newVal) {\n        if (newVal === val) {\n          return\n        }\n        val = newVal\n        dep.notify()\n      }\n    })\n  }\n}\n\n// 观察者的构造函数，接收一个表达式和回调函数\nclass Watcher {\n  constructor(vm, expOrFn, cb) {\n    this.vm = vm //Observer\n    this.getter = parsePath(expOrFn)\n    this.cb = cb\n    this.value = this.get()\n  }\n\n// watcher 实例触发值读取时，将依赖收集的目标对象设置成自身，\n// 通过 call 绑定当前 Vue 实例进行一次函数执行，在运行过程中收集函数中用到的数据\n// 此时会在所有用到数据的 dep 依赖管理中插入该观察者实例\n  get() {\n    Dep.target = this\n    const value = this.getter.call(this.vm, this.vm)\n// 函数执行完毕后将依赖收集目标清空，避免重复收集\n    Dep.target = null\n    return value\n  }\n\n// dep 依赖更新时会调用，执行回调函数\n  update() {\n    const oldValue = this.value\n    this.value = this.get()\n    this.cb.call(this.vm, this.value, oldValue)\n  }\n}\n\n// 依赖收集管理者的构造函数\nclass Dep {\n  constructor() {\n// 保存所有 watcher 观察者依赖数组\n    this.subs = []\n  }\n\n// 插入一个观察者到依赖数组中\n  addSub(sub) {\n    this.subs.push(sub)\n  }\n\n// 收集依赖，只有此时的依赖目标（watcher 实例）存在时才收集依赖\n  depend() {\n    if (Dep.target) {\n      this.addSub(Dep.target)\n    }\n  }\n\n// 发送更新，遍历依赖数组分别执行每个观察者定义好的 update 方法\n  notify() {\n    this.subs.forEach(sub =\u003e {\n      sub.update()\n    })\n  }\n}\n\n// 当前依赖收集的目标对象\nDep.target = null\n\n// 表达式解析\nfunction parsePath(path) {\n  const segments = path.split('.')\n  return function (obj) {\n    for (let i = 0; i \u003c segments.length; i++) {\n      if (!obj) {\n        return\n      }\n      obj = obj[segments[i]]\n    }\n    return obj\n  }\n}\n"]],"language":[["JavaScript"]]},"format":{"code_wrap":true},"created_time":1678246197708,"last_edited_time":1678247200447,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"3fab77db-abc6-49ae-ab59-3850c9947feb":{"role":"comment_only","value":{"id":"3fab77db-abc6-49ae-ab59-3850c9947feb","version":2,"type":"quote","properties":{"title":[["这里省略了数组部分，但是 数组本身的响应式监听 是通过重写数组方法来实现的，而 每个数组元素 则会再次进行 Observer 处理（需要数组在定义时就已经声明的数组元素）。"]]},"created_time":1678246197708,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"113f7e96-0241-4ca3-b331-15f97c0ab639":{"role":"comment_only","value":{"id":"113f7e96-0241-4ca3-b331-15f97c0ab639","version":2,"type":"text","properties":{"title":[["当然，因为 "],["Object.definePorperty",[["b"]]],[" 只能对 "],["对象的已知属性",[["b"]]],[" 进行操作，所有才会导致 "],["没有在 data 中进行声明的对象属性直接赋值时无法触发视图更新，需要通过魔法（",[["b"]]],["$set",[["b"],["c"]]],["）来处理",[["b"]]],["。而数组也应为是通过重新数组方法和遍历数组元素进行的响应式处理，也会导致按照数组下标进行赋值或者更改元素时无法触发视图更新。"]]},"created_time":1678246197708,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"b42d2e60-93ba-4866-b360-79a065b66d69":{"role":"comment_only","value":{"id":"b42d2e60-93ba-4866-b360-79a065b66d69","version":2,"type":"text","properties":{"title":[["例如："]]},"created_time":1678246197708,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"6ad5b0bc-1d9c-4f9e-9087-fdb170fff6d4":{"role":"comment_only","value":{"id":"6ad5b0bc-1d9c-4f9e-9087-fdb170fff6d4","version":2,"type":"code","properties":{"title":[["\u003cbody\u003e\n  \u003cdiv id=\"app\" class=\"demo-vm-1\"\u003e\n    \u003cp\u003e{{arr[0]}}\u003c/p\u003e\n    \u003cp\u003e{{arr[2]}}\u003c/p\u003e\n    \u003cp\u003e{{arr[3].c}}\u003c/p\u003e\n  \u003c/div\u003e\n\u003c/body\u003e\n\n\u003cscript\u003e\n  new Vue({\n    el: \"#app\",\n    data() {\n      return {\n        arr: [1, 2, { a: 3 },{ c: 5 }]\n      }\n    },\n    mounted() {\n      console.log(\"demo Instance: \", this.$data);\n\n      setTimeout(() =\u003e {\n        console.log('update')\n        this.arr[0] = { o: 1 }\n        this.arr[2] = { a: 1 }\n      },2000)\n    },\n  })\n\u003c/script\u003e"]],"language":[["Plain Text"]]},"format":{"code_wrap":true},"created_time":1678246197708,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"0319d0bf-1ad6-49b8-aac8-3e4f1a352393":{"role":"comment_only","value":{"id":"0319d0bf-1ad6-49b8-aac8-3e4f1a352393","version":4,"type":"text","properties":{"title":[["因为数组元素的前三个元素 "],["在定义时都是简单类型",[["b"]]],["，所以即使在模板中使用了该数据，也无法进行依赖收集和更新响应："]]},"created_time":1678246197708,"last_edited_time":1678247365162,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"9de28176-0100-49a4-9e37-c965dcf7f332":{"role":"comment_only","value":{"id":"9de28176-0100-49a4-9e37-c965dcf7f332","version":2,"type":"image","properties":{"source":[["https://mmbiz.qpic.cn/mmbiz_png/pman3QtrTawViclZEmHCpYTwM69daBBiaobASpEU3Hhcm3hKiagEhFLsIDt97O9ibu2KIxvDN7rEsrVWAl7Q8hmrTw/640?wx_fmt=png\u0026wxfrom=5\u0026wx_lazy=1\u0026wx_co=1"]]},"created_time":1678246197708,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"66085b49-5f84-42a6-be59-bf37d2fa569d":{"role":"comment_only","value":{"id":"66085b49-5f84-42a6-be59-bf37d2fa569d","version":2,"type":"text","properties":{"title":[["而本身的 "],["data",[["c"]]],[" 返回对象与 "],["arr, arr[3]",[["c"]]],[" 都有各自的 "],["dep",[["c"]]],[" 依赖数组，并且 "],["arr",[["c"]]],[" 和 "],["arr[3]",[["c"]]],[" 的依赖中都有同一个 "],["Watcher",[["c"]]],[" —— "],["RenderWacther",[["c"]]],[" 模板渲染。"]]},"created_time":1678246197709,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"18af2355-20ee-4312-95f4-450ee4148b55":{"role":"comment_only","value":{"id":"18af2355-20ee-4312-95f4-450ee4148b55","version":4,"type":"quote","properties":{"title":[["当然整个响应系统还包含依赖清理等其他操作，具体过程可以查看 Vue 2 阅读理解（十八）之响应式系统（一 ~ 四）Watcher"]]},"created_time":1678246197709,"last_edited_time":1678247369722,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"500117a3-be90-4f77-8daa-302b170453a6":{"role":"comment_only","value":{"id":"500117a3-be90-4f77-8daa-302b170453a6","version":14,"type":"image","properties":{"size":[["107.1KB"]],"title":[["Untitled"]],"source":[["https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6a41814e-b5b7-4143-a4d8-35195bc24e98/Untitled.png"]]},"format":{"block_width":960,"block_height":360,"display_source":"https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6a41814e-b5b7-4143-a4d8-35195bc24e98/Untitled.png","block_full_width":false,"block_page_width":true,"block_aspect_ratio":0.5625,"block_preserve_scale":true},"created_time":1678255713632,"last_edited_time":1678255720705,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"file_ids":["6a41814e-b5b7-4143-a4d8-35195bc24e98"],"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"e1cc7f78-1204-4fc5-bf0e-60e0417ea4c3":{"role":"comment_only","value":{"id":"e1cc7f78-1204-4fc5-bf0e-60e0417ea4c3","version":2,"type":"image","properties":{"source":[["data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E"]]},"created_time":1678246197709,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"cdd06622-d853-483a-a4e9-d8bb71c9c8f3":{"role":"comment_only","value":{"id":"cdd06622-d853-483a-a4e9-d8bb71c9c8f3","version":2,"type":"sub_header","properties":{"title":[["Vue 3 的响应式实现",[["b"]]]]},"created_time":1678246197709,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"11d62ff4-9d1b-4049-be7c-217cab0f01ba":{"role":"comment_only","value":{"id":"11d62ff4-9d1b-4049-be7c-217cab0f01ba","version":2,"type":"text","properties":{"title":[["碍于 "],["Object.defineProperty",[["c"]]],[" 的局限性，Vue 3 采用了全新的 "],["Proxy",[["c"]]],[" 对象来实现整个响应式系统基础。"]]},"created_time":1678246197710,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"7c5402b1-b8db-4670-a061-6def4dbf6db5":{"role":"comment_only","value":{"id":"7c5402b1-b8db-4670-a061-6def4dbf6db5","version":2,"type":"sub_sub_header","properties":{"title":[["什么是 Proxy ？",[["b"]]]]},"created_time":1678246197710,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"ce48ddc6-adda-484a-8ab3-3628a4f29b78":{"role":"comment_only","value":{"id":"ce48ddc6-adda-484a-8ab3-3628a4f29b78","version":2,"type":"text","properties":{"title":[["Proxy",[["c"]]],[" 是 "],["ES6",[["c"]]],[" 新增的一个构造函数，用来创建一个 "],["目标对象的代理对象，拦截对原对象的所有操作；用户可以通过注册相应的拦截方法来实现对象操作时的自定义行为",[["b"]]],["。"]]},"created_time":1678246197710,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"afa8f16d-b9a6-47b6-90ab-0dc5a2655a80":{"role":"comment_only","value":{"id":"afa8f16d-b9a6-47b6-90ab-0dc5a2655a80","version":2,"type":"text","properties":{"title":[["目前 "],["Proxy",[["c"]]],[" 支持的拦截方法包含一下内容："]]},"created_time":1678246197710,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"ebbc3278-a80d-4f60-95fe-beb4c024081e":{"role":"comment_only","value":{"id":"ebbc3278-a80d-4f60-95fe-beb4c024081e","version":2,"type":"bulleted_list","properties":{"title":[[""],["get(target, propKey, receiver)",[["c"]]],["：拦截对象属性的读取操作；"]]},"created_time":1678246197710,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"5f339f57-7b82-499e-bf69-8e2b660092f9":{"role":"comment_only","value":{"id":"5f339f57-7b82-499e-bf69-8e2b660092f9","version":2,"type":"bulleted_list","properties":{"title":[[""],["set(target, propKey, value, receiver)",[["c"]]],["：拦截对象属性的赋值操作；"]]},"created_time":1678246197711,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"341baaef-44ff-4505-8b33-d8368fbf21d6":{"role":"comment_only","value":{"id":"341baaef-44ff-4505-8b33-d8368fbf21d6","version":2,"type":"bulleted_list","properties":{"title":[[""],["apply(target, thisArg, argArray)",[["c"]]],["：拦截函数的调用操作；"]]},"created_time":1678246197711,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"b8d54078-14b5-4aac-891b-9fb1fa130994":{"role":"comment_only","value":{"id":"b8d54078-14b5-4aac-891b-9fb1fa130994","version":2,"type":"bulleted_list","properties":{"title":[[""],["construct(target, argArray, newTarget)",[["c"]]],["：拦截对象的实例化操作；"]]},"created_time":1678246197711,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"affa42e3-1521-4eff-b7a3-3d9cda7f6658":{"role":"comment_only","value":{"id":"affa42e3-1521-4eff-b7a3-3d9cda7f6658","version":2,"type":"bulleted_list","properties":{"title":[[""],["has(target, propKey)",[["c"]]],["：拦截 "],["in",[["c"]]],[" 操作符；"]]},"created_time":1678246197711,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"e59eb071-9aed-441e-af7a-13f497f8297a":{"role":"comment_only","value":{"id":"e59eb071-9aed-441e-af7a-13f497f8297a","version":2,"type":"bulleted_list","properties":{"title":[[""],["deleteProperty(target, propKey)",[["c"]]],["：拦截 "],["delete",[["c"]]],[" 操作符；"]]},"created_time":1678246197712,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"e1443c27-ea1a-4ab6-9a2d-cb1923895d86":{"role":"comment_only","value":{"id":"e1443c27-ea1a-4ab6-9a2d-cb1923895d86","version":2,"type":"bulleted_list","properties":{"title":[[""],["defineProperty(target, propKey, propDesc)",[["c"]]],["：拦截 "],["Object.defineProperty",[["c"]]],[" 方法；"]]},"created_time":1678246197712,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"0c4d5904-39cf-4d2d-b016-9a70bc099ddb":{"role":"comment_only","value":{"id":"0c4d5904-39cf-4d2d-b016-9a70bc099ddb","version":7,"type":"bulleted_list","properties":{"title":[[""],["getOwnPropertyDescriptor(target, propKey)",[["c"]]],["：拦截 "],["Object.getOwnPropertyDescriptor",[["c"]]],[" 方法；"]]},"created_time":1678246197712,"last_edited_time":1678247381549,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"7c9c0e16-d453-4c59-bc94-da17d8c419bf":{"role":"comment_only","value":{"id":"7c9c0e16-d453-4c59-bc94-da17d8c419bf","version":2,"type":"bulleted_list","properties":{"title":[[""],["getPrototypeOf(target)",[["c"]]],["：拦截 "],["Object.getPrototypeOf",[["c"]]],[" 方法；"]]},"created_time":1678246197712,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"f12643b0-c521-43ed-a83e-e094d821e428":{"role":"comment_only","value":{"id":"f12643b0-c521-43ed-a83e-e094d821e428","version":2,"type":"bulleted_list","properties":{"title":[[""],["setPrototypeOf(target, proto)",[["c"]]],["：拦截 "],["Object.setPrototypeOf",[["c"]]],[" 方法；"]]},"created_time":1678246197712,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"8c4d25df-b13e-4853-90de-a0e1334f25bb":{"role":"comment_only","value":{"id":"8c4d25df-b13e-4853-90de-a0e1334f25bb","version":2,"type":"bulleted_list","properties":{"title":[[""],["isExtensible(target)",[["c"]]],["：拦截 "],["Object.isExtensible",[["c"]]],[" 方法；"]]},"created_time":1678246197713,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"4071f8a5-a261-4feb-bffb-0130ace83fa1":{"role":"comment_only","value":{"id":"4071f8a5-a261-4feb-bffb-0130ace83fa1","version":2,"type":"bulleted_list","properties":{"title":[[""],["preventExtensions(target)",[["c"]]],["：拦截 "],["Object.preventExtensions",[["c"]]],[" 方法；"]]},"created_time":1678246197713,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"186444d7-d443-4647-b879-18f7a7585d2f":{"role":"comment_only","value":{"id":"186444d7-d443-4647-b879-18f7a7585d2f","version":2,"type":"bulleted_list","properties":{"title":[[""],["enumerate(target)",[["c"]]],["：拦截 "],["for...in",[["c"]]],[" 循环；"]]},"created_time":1678246197713,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"0b0a3e42-c951-4f8a-8217-5174a7c5cc89":{"role":"comment_only","value":{"id":"0b0a3e42-c951-4f8a-8217-5174a7c5cc89","version":2,"type":"bulleted_list","properties":{"title":[[""],["ownKeys(target)",[["c"]]],["：拦截 "],["Object.getOwnPropertyNames",[["c"]]],["、"],["Object.getOwnPropertySymbols",[["c"]]],["、"],["Object.keys",[["c"]]],["、"],["JSON.stringify",[["c"]]],[" 方法。"]]},"created_time":1678246197713,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"6ed7f0bf-3bb7-49fe-9134-ad6c1c10e994":{"role":"comment_only","value":{"id":"6ed7f0bf-3bb7-49fe-9134-ad6c1c10e994","version":2,"type":"text","properties":{"title":[["与 "],["Object,defineProperty",[["c"]]],[" 比起来，有非常明显的优势："]]},"created_time":1678246197714,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"0d0f973a-d513-4743-9a71-6da53f32a6a2":{"role":"comment_only","value":{"id":"0d0f973a-d513-4743-9a71-6da53f32a6a2","version":2,"type":"bulleted_list","properties":{"title":[["拦截操作更加多样"]]},"created_time":1678246197714,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"2ed16b7e-6164-456a-b9a2-d27a73696460":{"role":"comment_only","value":{"id":"2ed16b7e-6164-456a-b9a2-d27a73696460","version":2,"type":"bulleted_list","properties":{"title":[["拦截定义更加直接"]]},"created_time":1678246197714,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"0ccdb098-b4fb-4822-b57a-98f495927a81":{"role":"comment_only","value":{"id":"0ccdb098-b4fb-4822-b57a-98f495927a81","version":2,"type":"bulleted_list","properties":{"title":[["性能更加高效"]]},"created_time":1678246197714,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"a6af6927-0fb5-4a28-b65e-5dfd0b8b7bec":{"role":"comment_only","value":{"id":"a6af6927-0fb5-4a28-b65e-5dfd0b8b7bec","version":2,"type":"text","properties":{"title":[["在 Vue 中体现最为明显的一点就是："],["Proxy",[["c"]]],[" 代理对象之后不仅可以拦截对象属性的读取、更新、方法调用之外，对整个对象的新增、删除、枚举等也能直接拦截，而 "],["Object.defineProperty",[["c"]]],[" 只能针对对象的已知属性进行读取和更新的操作拦截。"]]},"created_time":1678246197714,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"5375187d-13cb-4354-8d46-78bfe3055dd9":{"role":"comment_only","value":{"id":"5375187d-13cb-4354-8d46-78bfe3055dd9","version":2,"type":"text","properties":{"title":[["例如："]]},"created_time":1678246197714,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"52db9a96-7e89-4a5d-812b-e7dfc8f5f76c":{"role":"comment_only","value":{"id":"52db9a96-7e89-4a5d-812b-e7dfc8f5f76c","version":2,"type":"code","properties":{"title":[["const obj = { name: 'MiyueFE', age: 28 };\nconst proxyObj = new Proxy(obj, {\n  get(target, property) {\n    console.log(`Getting ${property} value: ${target[property]}`);\n    return target[property];\n  },\n  set(target, property, value) {\n    console.log(`Setting ${property} value: ${value}`);\n    target[property] = value;\n  },\n  deleteProperty(target, property) {\n    console.log(`Deleting ${property} property`);\n    delete target[property];\n  },\n});\n\nconsole.log(proxyObj.name);// Getting name value: MiyueFE, 输出 \"MiyueFE\"\nproxyObj.name = 'MY';// Setting name value: MY\nconsole.log(proxyObj.name);// Getting name value: MY, 输出 \"MY\"\ndelete proxyObj.age;// Deleting age property\nconsole.log(proxyObj.age);// undefined"]],"language":[["Plain Text"]]},"format":{"code_wrap":true},"created_time":1678246197714,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"5b789732-1338-4ced-8d14-261f48271f62":{"role":"comment_only","value":{"id":"5b789732-1338-4ced-8d14-261f48271f62","version":2,"type":"quote","properties":{"title":[["但是 只有通过 proxyObj 进行操作的时候才能通过定义的操作拦截方法进行处理，直接使用原对象则无法触发拦截器。"]]},"content":["0fb792aa-9065-43a2-89d5-0472c3e529a8","90b4c8d2-8583-41bf-9a01-96b2e393d960"],"created_time":1678246197715,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"0fb792aa-9065-43a2-89d5-0472c3e529a8":{"role":"comment_only","value":{"id":"0fb792aa-9065-43a2-89d5-0472c3e529a8","version":2,"type":"text","properties":{"title":[["这也是 Vue 3 中要求的 "],["reactive",[["c"]]],[" 声明的对象修改原对象无法触发视图更新的原因。"]]},"created_time":1678246197714,"last_edited_time":1678246197760,"parent_id":"5b789732-1338-4ced-8d14-261f48271f62","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"90b4c8d2-8583-41bf-9a01-96b2e393d960":{"role":"comment_only","value":{"id":"90b4c8d2-8583-41bf-9a01-96b2e393d960","version":2,"type":"text","properties":{"title":[["并且 "],["Proxy",[["c"]]],[" 也只针对 "],["引用类型数据",[["b"]]],[" 才能进行代理，所以这也是 Vue 的基础数据都需要通过 "],["ref",[["c"]]],[" 进行声明的原因，内部会建立一个新对象保存原有的基础数据值。"]]},"created_time":1678246197715,"last_edited_time":1678246197760,"parent_id":"5b789732-1338-4ced-8d14-261f48271f62","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"f428a7de-1d49-414f-b304-9db35ad4a5ea":{"role":"comment_only","value":{"id":"f428a7de-1d49-414f-b304-9db35ad4a5ea","version":2,"type":"text","properties":{"title":[["例如："]]},"created_time":1678246197715,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"af02b798-549a-43f6-aa84-c3abc976de48":{"role":"comment_only","value":{"id":"af02b798-549a-43f6-aa84-c3abc976de48","version":2,"type":"code","properties":{"title":[["// 接上面的代码\nobj.name = \"newName\";// \"newName\"\nconsole.log(proxyObj.name);// Getting name value: newName;  \"newName\""]],"language":[["Plain Text"]]},"format":{"code_wrap":true},"created_time":1678246197715,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"cf0ce65a-09c5-435e-b1f1-e111197a60e7":{"role":"comment_only","value":{"id":"cf0ce65a-09c5-435e-b1f1-e111197a60e7","version":2,"type":"sub_sub_header","properties":{"title":[["响应式的实现",[["b"]]]]},"created_time":1678246197715,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"a78532a0-bd6a-40c7-ae7f-4994c640f583":{"role":"comment_only","value":{"id":"a78532a0-bd6a-40c7-ae7f-4994c640f583","version":2,"type":"text","properties":{"title":[["在选择了使用 "],["Proxy",[["c"]]],[" 代理来进行数据的操作拦截时，Vue 对依赖收集的逻辑也进行了修改，让我们分别来解析一下这两者的实现。"]]},"created_time":1678246197715,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"77648ddd-f661-47ab-873a-5d581e510b7b":{"role":"comment_only","value":{"id":"77648ddd-f661-47ab-873a-5d581e510b7b","version":2,"type":"sub_sub_header","properties":{"title":[["核心方法",[["b"]]]]},"created_time":1678246197716,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"a0961972-e572-4b51-9939-57096fc5017d":{"role":"comment_only","value":{"id":"a0961972-e572-4b51-9939-57096fc5017d","version":2,"type":"text","properties":{"title":[["Vue 提供了一下几个 "],["响应式数据声明",[["b"]]],[" 的核心 API："]]},"created_time":1678246197716,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"e3fded5f-f245-407d-9076-885dccdb7866":{"role":"comment_only","value":{"id":"e3fded5f-f245-407d-9076-885dccdb7866","version":2,"type":"bulleted_list","properties":{"title":[[""],["ref",[["c"]]],["：接受一个内部值，返回一个响应式的、可更改的 ref 对象，此对象只有一个指向其内部值的属性 "],[".value",[["c"]]],["。"],["function ref\u003cT\u003e(value: T): Ref\u003cUnwrapRef\u003cT\u003e\u003e",[["c"]]],["interface Ref\u003cT\u003e {",[["c"]]],[" value: T",[["c"]]],["}",[["c"]]]]},"created_time":1678246197716,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"3c60c6c5-3dcd-477a-8862-26cc321cceb8":{"role":"comment_only","value":{"id":"3c60c6c5-3dcd-477a-8862-26cc321cceb8","version":2,"type":"bulleted_list","properties":{"title":[[""],["shallowRef",[["c"]]],["："],["ref()",[["c"]]],[" 的浅层作用形式。"],["function shallowRef\u003cT\u003e(value: T): ShallowRef\u003cT\u003e",[["c"]]],["interface ShallowRef\u003cT\u003e {",[["c"]]],[" value: T",[["c"]]],["}",[["c"]]]]},"created_time":1678246197716,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"a589eab4-25c8-4d16-8cc7-67cde7759595":{"role":"comment_only","value":{"id":"a589eab4-25c8-4d16-8cc7-67cde7759595","version":2,"type":"bulleted_list","properties":{"title":[[""],["reactive",[["c"]]],["：返回一个对象的响应式代理。"],["function reactive\u003cT extends object\u003e(target: T): UnwrapNestedRefs\u003cT\u003e",[["c"]]]]},"created_time":1678246197716,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"a196d887-e815-415f-b21b-3fc9e47b3ac4":{"role":"comment_only","value":{"id":"a196d887-e815-415f-b21b-3fc9e47b3ac4","version":2,"type":"bulleted_list","properties":{"title":[[""],["shallowReactive",[["c"]]],["："],["reactive()",[["c"]]],[" 的浅层作用形式。"],["function shallowReactive\u003cT extends object\u003e(target: T): T",[["c"]]]]},"created_time":1678246197717,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"bfc0e175-a225-4a4d-883b-9086f8b063b9":{"role":"comment_only","value":{"id":"bfc0e175-a225-4a4d-883b-9086f8b063b9","version":2,"type":"bulleted_list","properties":{"title":[[""],["readonly",[["c"]]],["：接受一个对象 (不论是响应式还是普通的) 或是一个 ref，返回一个原值的只读代理。"],["function readonly\u003cT extends object\u003e(target: T): DeepReadonly\u003cUnwrapNestedRefs\u003cT\u003e\u003e",[["c"]]]]},"created_time":1678246197717,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"28ff5797-4171-48da-bde7-c64495c2a0f2":{"role":"comment_only","value":{"id":"28ff5797-4171-48da-bde7-c64495c2a0f2","version":2,"type":"bulleted_list","properties":{"title":[[""],["shallowReadonly",[["c"]]],["："],["readonly",[["c"]]],[" 的浅层作用形式"],["function shallowReadonly\u003cT extends object\u003e(target: T): Readonly\u003cT\u003e",[["c"]]]]},"created_time":1678246197717,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"bdab8f4a-35e0-4e9b-b61a-285cefe5e776":{"role":"comment_only","value":{"id":"bdab8f4a-35e0-4e9b-b61a-285cefe5e776","version":2,"type":"text","properties":{"title":[["其中 "],["ref",[["c"]]],[" 虽然常常有文章说一般只用来 "],["声明基础数据的响应式",[["b"]]],["，但是其实 **所有的数据类型声明响应式时都可以使用 "],["ref",[["c"]]],["**，只是内部为了同时实现基础数据的响应式处理，封装成了一个具有 "],["value",[["c"]]],[" 属性的对象，所以我们访问时必须通过 "],["xxx.value",[["c"]]],[" 的形式访问。"]]},"created_time":1678246197717,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"ef8ef2bd-041e-48be-8a6b-380a48063bdf":{"role":"comment_only","value":{"id":"ef8ef2bd-041e-48be-8a6b-380a48063bdf","version":2,"type":"text","properties":{"title":[["ref",[["c"]]],[" 函数内部执行时会创建一个 "],["RefImpl",[["c"]]],[" 类型的实例，其中的 "],["_value",[["c"]]],[" 就保存响应式数据，并定义了对象的 "],["get",[["c"]]],[" 和 "],["set",[["c"]]],[" 方法，用来收集依赖和发布更新事件。如果不是 "],["shallowRef",[["c"]]],[" 声明的浅层响应式数据的话，其 "],["_value",[["c"]]],[" 其实也会通过 "],["reactive",[["c"]]],[" 方法进行深层数据处理。"]]},"created_time":1678246197717,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"ebbb20aa-e2e4-4151-84d7-1e8e3429e009":{"role":"comment_only","value":{"id":"ebbb20aa-e2e4-4151-84d7-1e8e3429e009","version":2,"type":"text","properties":{"title":[["而 "],["reactive",[["c"]]],[" 与 "],["readonly",[["c"]]],[" 则比较相似，都是通过 "],["createReactiveObject",[["c"]]],[" 方法来创建一个 "],["Proxy",[["c"]]],[" 对象返回，只是 "],["readonly",[["c"]]],[" 的 "],["set",[["c"]]],[" 和 "],["deleteProperty",[["c"]]],[" 操作会直接拦截报错，提示禁止更新。"]]},"created_time":1678246197718,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"9c874e54-e6df-4a10-8c19-f98efa6109b6":{"role":"comment_only","value":{"id":"9c874e54-e6df-4a10-8c19-f98efa6109b6","version":2,"type":"text","properties":{"title":[["至于 "],["get",[["c"]]],[" 操作的拦截两者的大体思路差不多，不过 "],["readonly",[["b"],["c"]]],[" 因为只读的原因，数据不会发生改变，所以不会进行依赖收集操作",[["b"]]],["，如果有深层数据则会继续向内部进行同样的处理操作。"]]},"created_time":1678246197718,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"a37a9552-fdd4-4194-810b-168cdbd28227":{"role":"comment_only","value":{"id":"a37a9552-fdd4-4194-810b-168cdbd28227","version":2,"type":"text","properties":{"title":[["带有 "],["shallow",[["c"]]],[" 前缀的数据声明方法，结合官方的解释其实就明白了，整个定义 "],["类似深拷贝与浅拷贝的区别，即只处理首层数据",[["b"]]],["。代表假设使用 "],["shadowRef",[["c"]]],["、"],["shallowReactive",[["c"]]],[" 声明的对象，如果对象的某个属性也是对象，则 "],["只有当这个属性的引用地址发生改变时才会触发更新",[["b"]]],["；至于 "],["shallowReadobly",[["c"]]],[" 的话，其实就是读取什么返回什么，基本没有别的处理了。"]]},"created_time":1678246197718,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"603772f2-cd0c-4335-ab1c-393d988138ce":{"role":"comment_only","value":{"id":"603772f2-cd0c-4335-ab1c-393d988138ce","version":2,"type":"sub_sub_header","properties":{"title":[["操作拦截",[["b"]]]]},"created_time":1678246197718,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"f71789ba-36f9-4c1f-b899-a90908899a5c":{"role":"comment_only","value":{"id":"f71789ba-36f9-4c1f-b899-a90908899a5c","version":2,"type":"text","properties":{"title":[["因为篇幅的问题，我们直接从核心方法 "],["reactive",[["c"]]],[" 开始。"]]},"created_time":1678246197718,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"bf2a2e3d-2e62-4f01-b871-c6c239953f6a":{"role":"comment_only","value":{"id":"bf2a2e3d-2e62-4f01-b871-c6c239953f6a","version":2,"type":"text","properties":{"title":[["当我们通过 "],["reactive",[["c"]]],[" 创建一个响应式数据时，会调用以下方法："]]},"created_time":1678246197718,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"49d9cc2d-ba2c-4578-a58b-898dbefa63eb":{"role":"comment_only","value":{"id":"49d9cc2d-ba2c-4578-a58b-898dbefa63eb","version":124,"type":"code","properties":{"title":[["const reactiveMap = new WeakMap();\nfunction reactive(target) {\n  return createReactiveObject(target, false, mutableHandlers, mutableCollectionHandlers, reactiveMap);\n}\nfunction createReactiveObject(target, isReadonly, baseHandlers, collectionHandlers, proxyMap) {\n  if (target[\"__v_raw\"] \u0026\u0026 !(isReadonly \u0026\u0026 target[\"__v_isReactive\"])) {\n    return target;\n  }\n  const existingProxy = proxyMap.get(target);\n  if (existingProxy) {\n    return existingProxy;\n  }\n  const targetType = getTargetType(target);\n  if (targetType === 0) { //基础类型数据\n    return target;\n  }\n  const proxy = new Proxy(target, "],["targetType === 2",[["m","fe392f3b-c466-4045-b21a-fa7a17559b1c"]]],[" ? collectionHandlers : baseHandlers);\n  proxyMap.set(target, proxy);\n  return proxy;\n}"]],"language":[["JavaScript"]]},"discussions":["fe392f3b-c466-4045-b21a-fa7a17559b1c"],"format":{"code_wrap":true},"created_time":1678246197718,"last_edited_time":1678248378654,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"c5c831ae-995e-4e0b-84b2-57f38815b5c0":{"role":"comment_only","value":{"id":"c5c831ae-995e-4e0b-84b2-57f38815b5c0","version":2,"type":"quote","properties":{"title":[["省略了 readonly 判断和非引用数据判断。"]]},"created_time":1678246197718,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"3f0b296c-90ae-49c3-8cb6-8700ac985198":{"role":"comment_only","value":{"id":"3f0b296c-90ae-49c3-8cb6-8700ac985198","version":2,"type":"text","properties":{"title":[["在 "],["createReactiveObject",[["c"]]],[" 中首先判断了是否是 "],["保留原始数据",[["b"]]],[" 和 只读数据校验，然后判断这个目标数据时候已经处理过，这两种情况都直接返回。"]]},"created_time":1678246197719,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"011d64d7-d6ce-442f-9dbd-ed92b182c6f0":{"role":"comment_only","value":{"id":"011d64d7-d6ce-442f-9dbd-ed92b182c6f0","version":2,"type":"text","properties":{"title":[["然后通过 "],["getTargetType",[["c"]]],[" 判断数据类型："]]},"created_time":1678246197719,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"22a3995e-ebff-4b74-a8ed-b3f94904d2bb":{"role":"comment_only","value":{"id":"22a3995e-ebff-4b74-a8ed-b3f94904d2bb","version":4,"type":"code","properties":{"title":[["function targetTypeMap(rawType) {\n  switch (rawType) {\n    case \"Object\":\n    case \"Array\":\n      return 1/* COMMON */;\n    case \"Map\":\n    case \"Set\":\n    case \"WeakMap\":\n    case \"WeakSet\":\n      return 2/* COLLECTION */;\n    default:\n      return 0/* INVALID */;\n  }\n}"]],"language":[["JavaScript"]]},"format":{"code_wrap":true},"created_time":1678246197719,"last_edited_time":1678248263903,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"ef0bfa14-e080-4340-b69b-8814a011ddcf":{"role":"comment_only","value":{"id":"ef0bfa14-e080-4340-b69b-8814a011ddcf","version":2,"type":"text","properties":{"title":[["这里将数组和对象与 "],["ES6",[["c"]]],[" 新增的 "],["Set、Map",[["c"]]],[" 等进行了区分，非引用类型直接返回 "],["invalid",[["c"]]],[" 错误。"]]},"created_time":1678246197719,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"ae898c4c-06b0-4f3a-817c-2a1ad3f6eb5f":{"role":"comment_only","value":{"id":"ae898c4c-06b0-4f3a-817c-2a1ad3f6eb5f","version":2,"type":"text","properties":{"title":[["最后则是根据数据类型选择合适的处理程序进行拦截定义。"]]},"created_time":1678246197719,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"e8404a45-1d1b-4c75-a33c-527c71402052":{"role":"comment_only","value":{"id":"e8404a45-1d1b-4c75-a33c-527c71402052","version":2,"type":"text","properties":{"title":[["这里我们假设是一个对象或者数组，此时 "],["targetTypeMap",[["c"]]],[" 函数返回 1，也就是使用上面定义的 "],["mutableHandlers",[["c"]]],[" 进行处理。"]]},"created_time":1678246197719,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"e120dcfe-8932-4d55-8ef2-0d20d82ba130":{"role":"comment_only","value":{"id":"e120dcfe-8932-4d55-8ef2-0d20d82ba130","version":4,"type":"code","properties":{"title":[["const mutableHandlers = {\n  get: createGetter(),\n  set: createSetter(),\n  deleteProperty,\n  has,\n  ownKeys\n};\nfunction createGetter(isReadonly2 = false, shallow = false) {\n  return function get(target, key, receiver) {\n    if (key === \"__v_isReactive\"/* IS_REACTIVE */) {\n      return !isReadonly2;\n    } else if (key === \"__v_isReadonly\"/* IS_READONLY */) {\n      return isReadonly2;\n    } else if (key === \"__v_isShallow\"/* IS_SHALLOW */) {\n      return shallow;\n    } else if (key === \"__v_raw\"/* RAW */ \u0026\u0026 receiver === (isReadonly2 ? shallow ? shallowReadonlyMap : readonlyMap : shallow ? shallowReactiveMap : reactiveMap).get(target)) {\n      return target;\n    }\n    const targetIsArray = isArray(target);\n    if (!isReadonly2 \u0026\u0026 targetIsArray \u0026\u0026 hasOwn(arrayInstrumentations, key)) {\n      return Reflect.get(arrayInstrumentations, key, receiver);\n    }\n    const res = Reflect.get(target, key, receiver);\n    if (isSymbol(key) ? builtInSymbols.has(key) : isNonTrackableKeys(key)) {\n      return res;\n    }\n    if (!isReadonly2) {\n      track(target, \"get\"/* GET */, key);\n    }\n    if (shallow) {\n      return res;\n    }\n    if (isRef(res)) {\n      return targetIsArray \u0026\u0026 isIntegerKey(key) ? res : res.value;\n    }\n    if (isObject(res)) {\n      return isReadonly2 ? readonly(res) : reactive(res);\n    }\n    return res;\n  };\n}\nfunction has(target, key) {\n  const result = Reflect.has(target, key);\n  if (!isSymbol(key) || !builtInSymbols.has(key)) {\n    track(target, \"has\"/* HAS */, key);\n  }\n  return result;\n}\nfunction ownKeys(target) {\n  track(target, \"iterate\"/* ITERATE */, isArray(target) ? \"length\" : ITERATE_KEY);\n  return Reflect.ownKeys(target);\n}\n\n\nfunction createSetter(shallow = false) {\n  return function set(target, key, value, receiver) {\n    let oldValue = target[key];\n    if (isReadonly(oldValue) \u0026\u0026 isRef(oldValue) \u0026\u0026 !isRef(value)) {\n      return false;\n    }\n    if (!shallow) {\n      if (!isShallow(value) \u0026\u0026 !isReadonly(value)) {\n        oldValue = toRaw(oldValue);\n        value = toRaw(value);\n      }\n      if (!isArray(target) \u0026\u0026 isRef(oldValue) \u0026\u0026 !isRef(value)) {\n        oldValue.value = value;\n        return true;\n      }\n    } else {\n    }\n    const hadKey = isArray(target) \u0026\u0026 isIntegerKey(key) ? Number(key) \u003c target.length : hasOwn(target, key);\n    const result = Reflect.set(target, key, value, receiver);\n    if (target === toRaw(receiver)) {\n      if (!hadKey) {\n        trigger(target, \"add\"/* ADD */, key, value);\n      } else if (hasChanged(value, oldValue)) {\n        trigger(target, \"set\"/* SET */, key, value, oldValue);\n      }\n    }\n    return result;\n  };\n}\nfunction deleteProperty(target, key) {\n  const hadKey = hasOwn(target, key);\n  const oldValue = target[key];\n  const result = Reflect.deleteProperty(target, key);\n  if (result \u0026\u0026 hadKey) {\n    trigger(target, \"delete\"/* DELETE */, key, void 0, oldValue);\n  }\n  return result;\n}"]],"language":[["JavaScript"]]},"format":{"code_wrap":true},"created_time":1678246197719,"last_edited_time":1678248257780,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"7e1a01ae-716e-4ae4-bbf0-75a96160df29":{"role":"comment_only","value":{"id":"7e1a01ae-716e-4ae4-bbf0-75a96160df29","version":2,"type":"text","properties":{"title":[["在 "],["mutableHandlers",[["c"]]],[" 定义了 "],["get, set, deleteProperty, has, ownKeys",[["c"]]],[" 五个方法的拦截操作，其中 "],["set、deleteProperty",[["c"]]],[" 属于数据修改操作，会改变原有数据，所以在这两个方法中 "],["主要进行“更新消息派发”，也就是 ",[["b"]]],["trigger",[["b"],["c"]]],[" 方法",[["b"]]],["，而剩下的 "],["get、has、ownKeys",[["c"]]],[" 三个方法则只会访问数据的值，不改变原数据，所以这三个方法中 "],["主要进行“数据依赖收集”， 也就是 ",[["b"]]],["track",[["b"],["c"]]],[" 方法",[["b"]]],["。"]]},"created_time":1678246197720,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"064e526a-596c-4381-80ff-b604da2668b6":{"role":"comment_only","value":{"id":"064e526a-596c-4381-80ff-b604da2668b6","version":2,"type":"sub_sub_header","properties":{"title":[["依赖收集",[["b"]]]]},"created_time":1678246197720,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"00655ba5-f50b-4bcb-9e01-6115d4a75a00":{"role":"comment_only","value":{"id":"00655ba5-f50b-4bcb-9e01-6115d4a75a00","version":2,"type":"text","properties":{"title":[["在数据读取和更新时定义好了依赖收集和更新派发事件的执行时机之后，我们再回头看一下 Vue 3 的依赖收集系统。"]]},"created_time":1678246197720,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"8f3e14e2-58dd-4f6e-835c-50f0138d4167":{"role":"comment_only","value":{"id":"8f3e14e2-58dd-4f6e-835c-50f0138d4167","version":2,"type":"quote","properties":{"title":[["通过上文我们也知道在 Vue 2 中是给每个对象增加一个 Dep 实例来保存每个对象所关联的 Watcher 数组，然后更新时遍历执行，那么 Vue 3 是不是也是这么操作的呢？"]]},"created_time":1678246197720,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"8b4ab243-8af8-4186-8f38-24985adc5b9f":{"role":"comment_only","value":{"id":"8b4ab243-8af8-4186-8f38-24985adc5b9f","version":2,"type":"text","properties":{"title":[["答案是没有的。"]]},"created_time":1678246197720,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"c896fe04-4f6f-46dc-96bb-23c5c46cad41":{"role":"comment_only","value":{"id":"c896fe04-4f6f-46dc-96bb-23c5c46cad41","version":2,"type":"text","properties":{"title":[["因为 Vue 3 采用的 "],["Proxy",[["c"]]],[" 可以直接拦截对象的访问和更新，而无需像 "],["Object.defineProperty",[["c"]]],[" 一样单独为每个属性定义拦截，所以 "],["一个引用类型数据我们只需要收集一个依赖即可，通过一个全局变量进行所有的依赖数据的依赖管理",[["b"]]],["。"]]},"created_time":1678246197720,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"6309ceda-7033-4bc2-8f71-e2a76acdb77c":{"role":"comment_only","value":{"id":"6309ceda-7033-4bc2-8f71-e2a76acdb77c","version":2,"type":"code","properties":{"title":[["const targetMap = new WeakMap();\nlet shouldTrack = true;\nlet activeEffect = null;\n\nfunction track(target, type, key) {\n  if (shouldTrack \u0026\u0026 activeEffect) {\n    let depsMap = targetMap.get(target)\n    if (!depsMap) targetMap.set(target, (depsMap = new Map()))\n    let dep = depsMap.get(key)\n    if (!dep) depsMap.set(key, (dep = createDep()))\n    const eventInfo = { effect: activeEffect, target, type, key }\n    trackEffects(dep, eventInfo)\n  }\n}\nfunction trackEffects(dep, debuggerEventExtraInfo) {\n  let shouldTrack2 = false;\n  if (effectTrackDepth \u003c= maxMarkerBits) {\n    if (!newTracked(dep)) {\n      dep.n |= trackOpBit;\n      shouldTrack2 = !wasTracked(dep);\n    }\n  } else {\n    shouldTrack2 = !dep.has(activeEffect);\n  }\n  if (shouldTrack) {\n    dep.add(activeEffect)\n    activeEffect.deps.push(dep)\n  }\n}"]],"language":[["Plain Text"]]},"format":{"code_wrap":true},"created_time":1678246197720,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"1971e3f9-6d24-42bf-a030-4e690b25e49b":{"role":"comment_only","value":{"id":"1971e3f9-6d24-42bf-a030-4e690b25e49b","version":2,"type":"quote","properties":{"title":[["以上代码就是依赖收集部分的大致逻辑，通过 track 函数，在 shouldTrack 标识为 true 且存在激活副作用函数 activeEffect 时，会在 全局的依赖管理中心 targetMap 中插入该数据，并为该数据添加一个 Set 格式的 dep 依赖，将激活状态的副作用 activeEffect 插入到 dep 中"]]},"created_time":1678246197720,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"84b6cefa-2af7-426b-86e0-8a5da254c32f":{"role":"comment_only","value":{"id":"84b6cefa-2af7-426b-86e0-8a5da254c32f","version":2,"type":"text","properties":{"title":[["收集到的依赖内容如下："]]},"created_time":1678246197720,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"de34e673-99c0-4934-a7ee-430bd0f8cb10":{"role":"comment_only","value":{"id":"de34e673-99c0-4934-a7ee-430bd0f8cb10","version":2,"type":"image","properties":{"source":[["data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E"]]},"created_time":1678246197720,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"e301b360-b742-425a-8092-1eb2634cc742":{"role":"comment_only","value":{"id":"e301b360-b742-425a-8092-1eb2634cc742","version":12,"type":"image","properties":{"size":[["141.8KB"]],"title":[["Untitled"]],"source":[["https://s3-us-west-2.amazonaws.com/secure.notion-static.com/685fa767-e023-4232-9d98-b75816e90460/Untitled.png"]]},"format":{"block_width":901,"display_source":"https://s3-us-west-2.amazonaws.com/secure.notion-static.com/685fa767-e023-4232-9d98-b75816e90460/Untitled.png","block_full_width":false,"block_page_width":true,"block_aspect_ratio":0.827968923418424,"block_preserve_scale":true},"created_time":1678255824688,"last_edited_time":1678255832839,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"file_ids":["685fa767-e023-4232-9d98-b75816e90460"],"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"47fd9a4c-28c5-459b-8981-56f04430c329":{"role":"comment_only","value":{"id":"47fd9a4c-28c5-459b-8981-56f04430c329","version":2,"type":"sub_sub_header","properties":{"title":[["副作用定义",[["b"]]]]},"created_time":1678246197721,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"c99f832b-1cd1-4a02-b003-2095ea803144":{"role":"comment_only","value":{"id":"c99f832b-1cd1-4a02-b003-2095ea803144","version":2,"type":"text","properties":{"title":[["Vue 3 中的副作用函数称为 "],["effect",[["c"]]],["，官方也提供了该函数的直接调用，在 "],["执行时能自动收集相关依赖",[["b"]]],["。其定义如下："]]},"created_time":1678246197721,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"8d53c050-33b5-4156-a051-99480110a0dc":{"role":"comment_only","value":{"id":"8d53c050-33b5-4156-a051-99480110a0dc","version":4,"type":"code","properties":{"title":[["function effect(fn, options) {\n  if (fn.effect) {\n    fn = fn.effect.fn;\n  }\n  const _effect = new ReactiveEffect(fn);\n  if (options) {\n    extend(_effect, options);\n    if (options.scope)\n      recordEffectScope(_effect, options.scope);\n  }\n  if (!options || !options.lazy) {\n    _effect.run();\n  }\n  const runner = _effect.run.bind(_effect);\n  runner.effect = _effect;\n  return runner;\n}"]],"language":[["JavaScript"]]},"format":{"code_wrap":true},"created_time":1678246197721,"last_edited_time":1678255892626,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"d14c5789-d7cb-4edd-bcd8-a45d08960d21":{"role":"comment_only","value":{"id":"d14c5789-d7cb-4edd-bcd8-a45d08960d21","version":2,"type":"text","properties":{"title":[["它的本质呢其实就是 "],["返回一个绑定了当前作用域并且在内部封装过其他操作的 ",[["b"]]],["fn",[["b"],["c"]]],[" 函数的新函数",[["b"]]],["（"],["render",[["c"]]],[" 最终也会封装成一个 副作用函数），"],["effect",[["c"]]],[" 函数内部的核心逻辑还是创建一个 "],["ReactiveEffect",[["c"]]],[" 实例。"]]},"created_time":1678246197721,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"a9070203-47e5-47c7-9854-a2223f5586aa":{"role":"comment_only","value":{"id":"a9070203-47e5-47c7-9854-a2223f5586aa","version":2,"type":"text","properties":{"title":[["那么我们接着进入 "],["ReactiveEffect",[["c"]]],[" 内部看看。"]]},"created_time":1678246197721,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"4f88acee-088c-491c-ab8c-3e082a0e93c3":{"role":"comment_only","value":{"id":"4f88acee-088c-491c-ab8c-3e082a0e93c3","version":6,"type":"code","properties":{"title":[["class ReactiveEffect {\n    constructor(fn, scheduler) {\n        this.fn = fn;\n        this.scheduler = scheduler;\n        this.active = true;\n        this.deps = [];\n    }\n    run() {\n        if (!this.active) {\n            return this.fn();\n        }\n        shouldTrack = true;\n        activeEffect = this;\n        const result = this.fn();\n        shouldTrack = false;\n        activeEffect = undefined;\n        return result;\n    }\n    stop() {\n        if (this.active) {\n            cleanupEffect(this);\n            if (this.onStop) {\n                this.onStop();\n            }\n            this.active = false;\n        }\n    }\n}\nfunction cleanupEffect(effect) {\n    effect.deps.forEach((dep) =\u003e {\n        dep.delete(effect);\n    });\n    effect.deps.length = 0;\n}"]],"language":[["JavaScript"]]},"format":{"code_wrap":true},"created_time":1678246197722,"last_edited_time":1678255959550,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"27cda12e-75bf-4d83-af7d-5f37be4dcd0f":{"role":"comment_only","value":{"id":"27cda12e-75bf-4d83-af7d-5f37be4dcd0f","version":2,"type":"quote","properties":{"title":[["这里对部分代码进行了简化，保留了依赖收集和停止处理的相关逻辑。"]]},"created_time":1678246197722,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"79d4cf9c-4228-4c59-b3a7-1c2bc198a551":{"role":"comment_only","value":{"id":"79d4cf9c-4228-4c59-b3a7-1c2bc198a551","version":2,"type":"text","properties":{"title":[["在上文的 "],["effect",[["c"]]],[" 函数执行时，会调用 "],["ReactiveEffect",[["c"]]],[" 实例的 "],["run",[["c"]]],[" 方法，执行副作用定义的函数 "],["fn",[["c"]]],[" 并将当前的 "],["activeEffect",[["c"]]],[" 设置为该实例。"]]},"created_time":1678246197722,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"b913a7f9-f4a6-4793-9f24-6b58e514a188":{"role":"comment_only","value":{"id":"b913a7f9-f4a6-4793-9f24-6b58e514a188","version":2,"type":"text","properties":{"title":[["fn",[["c"]]],[" 函数执行时，遇到定义的响应式变量就会触发相应的 "],["get",[["c"]]],[" 操作，此时就会将当前的副作用实例（也就是 "],["ReactiveEffect",[["c"]]],[" 实例）插入到该变量的 "],["dep",[["c"]]],[" 数据，完成依赖收集过程。"]]},"created_time":1678246197722,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"b7cb43e6-58cc-4068-b2b3-f82cc552d1fb":{"role":"comment_only","value":{"id":"b7cb43e6-58cc-4068-b2b3-f82cc552d1fb","version":2,"type":"text","properties":{"title":[["并且 Vue 3 中的 "],["ReactiveEffect",[["c"]]],[" 提供了一个 "],["stop",[["c"]]],[" 方法，在调用时会清空该副作用相关的所有数据依赖，并且将 "],["this.active",[["c"]]],[" 设置为 "],["false",[["c"]]],["，避免后续执行时的依赖收集。"]]},"created_time":1678246197722,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"66ed567f-6e10-4887-8048-f3d2cf5e8413":{"role":"comment_only","value":{"id":"66ed567f-6e10-4887-8048-f3d2cf5e8413","version":2,"type":"sub_sub_header","properties":{"title":[["派发更新",[["b"]]]]},"created_time":1678246197722,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"78a967e2-4859-4823-89e1-fa7a60d5ae62":{"role":"comment_only","value":{"id":"78a967e2-4859-4823-89e1-fa7a60d5ae62","version":2,"type":"text","properties":{"title":[["当数据更新时，即触发 "],["set、deleteProperty",[["c"]]],[" 等拦截时，就需要触发相应的依赖函数执行（也就是视图更新、"],["watch",[["c"]]],[" 执行等），其核心就是 "],["遍历 ",[["b"]]],["targetMap",[["b"],["c"]]],[" 中该数据对应的 ",[["b"]]],["dep",[["b"],["c"]]],[" 中的每个副作用函数执行",[["b"]]],["。"]]},"created_time":1678246197722,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"2260b5c6-c075-496d-98ed-f7e241ec4a92":{"role":"comment_only","value":{"id":"2260b5c6-c075-496d-98ed-f7e241ec4a92","version":2,"type":"text","properties":{"title":[["大致代码如下："]]},"created_time":1678246197723,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"87ad0d0b-05fa-465f-8aad-0148a57d210d":{"role":"comment_only","value":{"id":"87ad0d0b-05fa-465f-8aad-0148a57d210d","version":4,"type":"code","properties":{"title":[["function trigger(target, type, key, newValue, oldValue, oldTarget) {\n  const depsMap = targetMap.get(target);\n  if (!depsMap) return;\n  let deps = [];\n  if (type === \"clear\") {\n    deps = [...depsMap.values()];\n  } else if (key === \"length\" \u0026\u0026 isArray(target)) {\n    depsMap.forEach((dep, key2) =\u003e ((key2 === \"length\" || key2 \u003e= newValue) \u0026\u0026 deps.push(dep)));\n  } else {\n    if (key !== void 0) {\n      deps.push(depsMap.get(key));\n    }\n  }\n  const effects = [];\n  for (const dep of deps) {\n    dep \u0026\u0026 effects.push(...dep);\n  }\n  triggerEffects(createDep(effects));\n}\n\nfunction triggerEffects(dep) {\n  const effects = isArray(dep) ? dep : [...dep];\n  for (const effect of effects) {\n    triggerEffect(effect)\n  }\n}\n\nfunction triggerEffect(effect) {\n  if (effect !== activeEffect || effect.allowRecurse) {\n    effect.scheduler ? effect.scheduler() : effect.run();\n  }\n}"]],"language":[["JavaScript"]]},"format":{"code_wrap":true},"created_time":1678246197723,"last_edited_time":1678255946614,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"cce946fd-9f98-4b27-9241-fdd4664e2576":{"role":"comment_only","value":{"id":"cce946fd-9f98-4b27-9241-fdd4664e2576","version":2,"type":"text","properties":{"title":[["简单理解就是："]]},"created_time":1678246197723,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"85165486-5f63-40da-8d8e-dafc405ad42e":{"role":"comment_only","value":{"id":"85165486-5f63-40da-8d8e-dafc405ad42e","version":6,"type":"numbered_list","properties":{"title":[["通过 "],["targetMap.get(target)",[["c"]]],[" 获取到该数据对应的 "],["depsMap",[["c"]]],[" 依赖数据"]]},"created_time":1678246197723,"last_edited_time":1678256248828,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"3abda3b1-fcfb-48fc-ae72-2bfe4a4a8019":{"role":"comment_only","value":{"id":"3abda3b1-fcfb-48fc-ae72-2bfe4a4a8019","version":6,"type":"numbered_list","properties":{"title":[["在 "],["deps",[["c"]]],[" 数组中插入这个操作 "],["key",[["c"]]],[" 对应的副作用函数，也就是 "],["deps.push(depsMap.get(key))",[["c"]]]]},"created_time":1678246197723,"last_edited_time":1678256262799,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"83826c6d-09e7-4690-846f-13bb781d1da6":{"role":"comment_only","value":{"id":"83826c6d-09e7-4690-846f-13bb781d1da6","version":6,"type":"numbered_list","properties":{"title":[["通过 "],["createDep",[["c"]]],[" 去除重复 "],["effect",[["c"]]],[" 副作用，调用 "],["triggerEffect",[["c"]]]]},"created_time":1678246197723,"last_edited_time":1678256261025,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"8e33a75f-f7db-4fdc-8fd7-bb91499c121a":{"role":"comment_only","value":{"id":"8e33a75f-f7db-4fdc-8fd7-bb91499c121a","version":11,"type":"numbered_list","properties":{"title":[["遍历 "],["effects",[["c"]]],[" 并执行副作用函数"]]},"created_time":1678246197723,"last_edited_time":1678256259510,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"65079663-dc84-4ad2-9cf7-effcf55e5b87":{"role":"comment_only","value":{"id":"65079663-dc84-4ad2-9cf7-effcf55e5b87","version":2,"type":"sub_header","properties":{"title":[["小结一下",[["b"]]]]},"created_time":1678246197724,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"d8c6006d-0497-4cc8-9009-1ea557f53aaf":{"role":"comment_only","value":{"id":"d8c6006d-0497-4cc8-9009-1ea557f53aaf","version":2,"type":"text","properties":{"title":[["对比起 Vue 2 通过 "],["Object.defineProperty",[["c"]]],[" 在数据定义时为指定具体属性添加 "],["getter/setter",[["c"]]],[" 拦截、为每个对象添加 "],["deps",[["c"]]],[" 依赖数组的响应式系统实现方式，Vue 3 采用 "],["ES6",[["c"]]],[" 的 "],["Proxy",[["c"]]],[" 结合 "],["WeakMap、WeakSet",[["c"]]],[" ，通过代理在运行时拦截对象的基本操作来收集依赖并全局管理，在性能上就得到了很大的提升，也为开发者带来了更好的开发体验。"]]},"created_time":1678246197724,"last_edited_time":1678246197760,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"398ff128-98ad-4e56-8679-08eadc1449e7":{"role":"comment_only","value":{"id":"398ff128-98ad-4e56-8679-08eadc1449e7","version":4,"type":"text","properties":{"title":[["并且通过全局的依赖管理模式，也让 Vue 3 的组合式 API 和 "],["hooks",[["c"]]],[" 开发模式得以实现，在进行大型项目开发时，公共逻辑拆分也会变得更加清晰。"]]},"created_time":1678246197724,"last_edited_time":1678246219168,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}},"322ec9a8-33fb-4f03-850f-79aca4c35c51":{"role":"comment_only","value":{"id":"322ec9a8-33fb-4f03-850f-79aca4c35c51","version":5,"type":"text","created_time":1678255936674,"last_edited_time":1678255938915,"parent_id":"b02d7c09-9db4-480c-8082-a3631db20f71","parent_table":"block","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","last_edited_by_table":"notion_user","last_edited_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}}},"collection":{"41b2dc5d-80f3-41b0-8de7-04219fb08277":{"role":"comment_only","value":{"id":"41b2dc5d-80f3-41b0-8de7-04219fb08277","version":99,"name":[["文章"]],"schema":{"ATb=":{"name":"author","type":"text"},"QWo:":{"name":"Created","type":"created_time","date_format":"YYYY/MM/DD"},"QZ{H":{"name":"Tags","type":"multi_select","options":[{"id":"v:n_","color":"pink","value":"VsCode"},{"id":"X^GZ","color":"green","value":"小程序"},{"id":"^rk:","color":"brown","value":"工程类"},{"id":"eGGv","color":"pink","value":"TypeScript"},{"id":"rjJW","color":"default","value":"Node.js"},{"id":"Jf~k","color":"red","value":"CSS"},{"id":"~bNP","color":"purple","value":"Vue3"},{"id":"tUDt","color":"gray","value":"Vue2"},{"id":"PQFG","color":"blue","value":"Vue"},{"id":"Qw`W","color":"orange","value":"React"},{"id":"ki\\]","color":"yellow","value":"Javascript"},{"id":"2fbd300a-7611-43dc-bd19-01bd2cdd2aed","color":"orange","value":"小程序"}]},"hm[q":{"name":"Category","type":"text"},"ldvU":{"name":"Last edited time","type":"last_edited_time","date_format":"YYYY/MM/DD","time_format":"H:mm"},"oSST":{"name":"Date","type":"date"},"title":{"name":"Title","type":"title"}},"format":{"page_section_visibility":{"comments":"section_show","backlinks":"section_collapsed","margin_comments":"inline"},"collection_page_properties":[{"visible":true,"property":"QWo:"},{"visible":true,"property":"QZ{H"}]},"parent_id":"d1d5df90-9871-450b-9aa0-5b65b0c967fc","parent_table":"block","alive":true,"migrated":true,"space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}}},"collection_view":{"56c062c2-e19b-4f5b-9075-3b233d1067e5":{"role":"comment_only","value":{"id":"56c062c2-e19b-4f5b-9075-3b233d1067e5","version":156,"type":"gallery","name":"JavaScript","format":{"board_columns":[{"value":{"type":"multi_select","value":"CSS"},"property":"QZ{H"},{"value":{"type":"multi_select","value":"Javascript"},"property":"QZ{H"},{"value":{"type":"multi_select","value":"Node.js"},"property":"QZ{H"},{"value":{"type":"multi_select","value":"React"},"property":"QZ{H"},{"value":{"type":"multi_select","value":"TypeScript"},"property":"QZ{H"},{"value":{"type":"multi_select","value":"VsCode"},"property":"QZ{H"},{"value":{"type":"multi_select","value":"Vue"},"property":"QZ{H"},{"value":{"type":"multi_select","value":"Vue2"},"property":"QZ{H"},{"value":{"type":"multi_select","value":"Vue3"},"property":"QZ{H"},{"value":{"type":"multi_select"},"property":"QZ{H"}],"gallery_cover":{"type":"page_content"},"board_columns_by":{"sort":{"type":"manual"},"type":"multi_select","property":"QZ{H"},"collection_groups":[{"value":{"type":"multi_select","value":"CSS"},"property":"QZ{H"},{"value":{"type":"multi_select","value":"Javascript"},"property":"QZ{H"},{"value":{"type":"multi_select","value":"Node.js"},"property":"QZ{H"},{"value":{"type":"multi_select","value":"React"},"property":"QZ{H"},{"value":{"type":"multi_select","value":"TypeScript"},"property":"QZ{H"},{"value":{"type":"multi_select","value":"VsCode"},"property":"QZ{H"},{"value":{"type":"multi_select","value":"Vue"},"property":"QZ{H"},{"value":{"type":"multi_select","value":"Vue2"},"property":"QZ{H"},{"value":{"type":"multi_select","value":"Vue3"},"property":"QZ{H"},{"value":{"type":"multi_select","value":"小程序"},"hidden":false,"property":"QZ{H"},{"value":{"type":"multi_select"},"property":"QZ{H"}],"collection_pointer":{"id":"41b2dc5d-80f3-41b0-8de7-04219fb08277","table":"collection","spaceId":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"},"gallery_cover_size":"small","gallery_properties":[{"visible":true,"property":"title"},{"visible":true,"property":"QZ{H"},{"visible":true,"property":"ldvU"},{"visible":false,"property":"QWo:"},{"visible":true,"property":"hm[q"}],"collection_group_by":{"sort":{"type":"manual"},"type":"multi_select","property":"QZ{H"},"gallery_cover_aspect":"contain"},"parent_id":"d1d5df90-9871-450b-9aa0-5b65b0c967fc","parent_table":"block","alive":true,"page_sort":["a99eeda4-6831-4a35-a4fd-035168318c1f","b62d64c2-9b6a-428d-a4c9-9ca00164b496","6614d4c1-f00e-4716-a5d5-da59a67c50c9","1f0e1e8d-0a50-4654-87f9-198986132eff","0c3691ec-0832-47ba-aa0a-9e9a38b52b20","16c31531-fee2-403c-a229-e6e0be1303ef","8302dd7a-69d1-40fb-a7c2-73432af0a8c4","a22e6174-d4e9-42f2-9c33-6e548b916d93","f29c351e-86cf-4134-887c-a4365d8d8eaf","0405c992-2cc7-41cc-b6b5-7fe5ca90e25c","24135f07-7414-43a4-b169-7529b57fbde7","cc6c5b63-6c0f-49ee-879a-17b4ed6592a0","1f707436-a145-4f9c-91a3-50a44e79e424","8b9a1c83-27d1-45d0-860a-05d1c926da9b","d5ba8061-8143-4f79-ba98-bd0a9920082d","59d2d17a-578a-443b-b363-215c45c116ea","bfadaf82-8405-47d5-85d1-32781e3f90fa","673625e2-cf27-4167-8731-2459c2508655","0bc90d0c-aadb-44a9-bbdb-8544f65d04aa","04f769d7-835a-4df4-8ce3-789722e888a4","0e2d0f1f-2e05-40e7-a2c3-70415abc2891","d1650851-b684-4a14-b1eb-452fdb62fe8d","b10c58bd-6c34-48fe-9d0b-0c7426e284ee","9ff96755-2a24-485b-bf9d-73514ca421e8","52748241-1854-46b1-a33c-5375c57b4774","f67a580d-0f73-47bd-87e7-3a22b7437418","e5ee09b2-8328-40ab-8963-6bbd6ff1fb28","1dd74f9d-5607-4090-a5cf-1ca1ce3f6b8f","ce137707-3785-4589-ac9e-fbb38a89be8a","052f8794-4cdd-4594-bba0-e2179dda6e8a","4846752c-183c-49c5-8ff6-4d4b5818ff23","6b5f418f-e272-457f-a0d4-ade10e4ddba1","a13c5b49-709c-44db-8a24-119e6fb82aeb","13e1e548-a6df-4fc4-9792-88b13432f0a4","9cc94e4c-e876-4d5f-b4ee-5b99864845b7","4af4004c-7c31-4e3f-8ce9-bd12e092e79c","09b66703-a0b7-4ee0-834c-7a6e5e729c42","fdc5b818-ff22-4ac7-b404-b99f0441ffd0","0bb0bd9b-2a10-4ef7-b9e8-949bb84d9124","d4740337-d6f9-4a0b-8453-fa9f7dd8a902","1b6aa408-8aa6-4b22-9a2d-3e7642ccbfdd","2408e513-91cd-4b5d-bb2f-0a85bfc95302","ce2627d6-ed5d-489b-80f8-f957b4c1a9a5","3ae8503d-29a5-4c57-a08d-c1dfc17c48e5","b02d7c09-9db4-480c-8082-a3631db20f71","1896c2fd-ae90-4081-ace6-c8dfa57ec3c3","1927cfa6-50ca-47e3-b586-2fbeab97a1f9","f34c7229-8fbf-4051-8a8d-2b3db5ba51b0","b359ccf1-f043-4b79-9924-a827fed5f444","246ebb3a-a2f5-44c8-8cac-4640ba2786b4","533a4cd5-9c5c-4a8a-ac9a-500b0c6b6ce1","13df7f86-9462-46bb-a7f7-7b9e4a7b315b","4444edf2-828f-4ae7-9c53-91b1837999b0","4cb5e948-2235-4248-b66c-0a2aed721964","f167fe30-d00e-4ea9-b1cf-92f2d965c7b9","1ce2ead1-bb6d-43bb-9e15-40ddd1c4affb","4f1bec10-66e9-4add-9e80-78a19ca76625","bf867b28-1c57-4e94-babb-4df34332a762","65c23267-8fd2-40a1-b52f-623d94c115d0","51e85497-fb51-4db1-81e5-b4337b610009","d2c7c249-c5e0-4af9-9655-266342739cf5","53359371-b754-4d01-a6ad-5cb5d0b08d22","22849ceb-b2e8-454b-9389-08a8fabd8eb5","c2e9114e-fd1d-4cad-a7a4-d7e56daaba3d","a192e8d3-8b60-48a4-8830-b78bcc8c3631","588a6f6c-451b-41a3-bf02-16ee45605585","2e17f655-9dc8-4546-a93a-812753190e44","73aa2423-5b13-47a4-9a67-e1902a75cf56","c4ba55b8-a172-4843-b918-19fec6f89059","4f3f32dd-c05d-43d8-b54f-355a1726001a","95b03413-0e8f-4635-b5bb-0e3c8de6c9e5","09236e78-50da-4199-b246-70fdd593efd5","61e925c0-9669-4717-a087-6ce2a6545b12","0124d3d9-351b-4d48-9a77-a5f9f6c72096","744754bd-fb95-4cb5-b58e-958a2ff13516","9d436ab0-b4ea-450f-b58b-223909d8c3f6","decdb9b5-7045-40a9-8c36-f5f3615bf53c","c52af969-205e-4321-a7a4-9d489a439e6a","00c8bbe0-ada9-4075-9ec1-809466a894cc","ea37e430-2135-4b3c-a1d1-6f3e84f728df","0b440e59-8e85-426f-a202-69ecc467af56","19883d58-6084-4e5a-ba31-0d64db7aa54c","b2f23b9d-f7aa-455f-8dd9-b6de93c4f60b","fab659d3-1261-4742-ad7e-0ed7a35b487b","4293012d-5f73-44fd-8ac5-47eadd2b43be","8869de2c-3eb4-4d85-b63f-4d71a770b491","539e637a-e2be-41f3-8202-41b2aa25f461","72a421dd-d3e9-4fe7-bde0-17149f39c9cd","96e9e041-62eb-4a35-88d9-c50c6f5b6149","9ab33bf8-54c5-4d9a-9738-43ad39ee0d20","495b935d-781e-4439-8e0c-83ecee52981c","381ab785-e343-4b37-9283-135a32bd4312","b0d98a97-e29d-4e2c-ad81-ecaeaf20d614","2018bcb0-e3fd-408d-935a-573333de7563","39e045c8-ebe0-43db-bf66-11e84b23f207","929f7101-9499-4849-963a-1b364b173dc0","6de98e9d-3b1d-41a8-ba84-3e30037b5bfb","686f2b18-87ca-4a0a-83d7-f29400933fb1","21b6c338-6ad3-4b4a-ad11-42752276d964","9ce72e65-f73a-402e-b3d0-1c43a4130d64","758b0a3e-7dd1-4d7d-aacd-73dab0913da9","21d568e7-19e4-4af0-908a-2c97d435a9f3","4bc4d5a7-e1cc-410b-970c-2be2ebfd4b03","cb8f5048-4d2b-4f52-b266-499c0bafc1f7","4c356e26-61a9-4f2c-b0f4-9cd4fb1389c1","aae9e4f1-af7b-452d-a159-8a364cb5709a","c9bc3d93-b235-4eea-ad5a-c7462b04b569","f1011465-4937-42d2-8ca5-c29110889f69","04794511-90d0-40de-bfa5-c1629b6c7ab5","68929a21-2aec-44ed-830b-0d7abd3a31ab","dfdfd936-d64c-457b-b9a5-42086c891933","bfa8f335-dacc-4169-af6e-512a9fbfd284","299bece4-1f69-4999-b294-00bac345ddca","c64083ca-f3aa-47c7-b64f-08810ead6be1","4eff5432-f6a4-441c-91b2-5382800cc391","236a80c4-149c-4ace-b757-fdfc04d27905"],"query2":{"calendar_by":"QWo:","timeline_by":"oSST"},"space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}}},"team":{},"space":{},"discussion":{"fe392f3b-c466-4045-b21a-fa7a17559b1c":{"role":"comment_only","value":{"id":"fe392f3b-c466-4045-b21a-fa7a17559b1c","version":2,"parent_id":"49d9cc2d-ba2c-4578-a58b-898dbefa63eb","parent_table":"block","context":[["targetType === 2",[["m","fe392f3b-c466-4045-b21a-fa7a17559b1c"]]]],"resolved":false,"comments":["cfbd7bbc-b4f4-4ee8-be63-e444195420be"],"space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}}},"comment":{"cfbd7bbc-b4f4-4ee8-be63-e444195420be":{"role":"comment_only","value":{"id":"cfbd7bbc-b4f4-4ee8-be63-e444195420be","version":4,"parent_id":"fe392f3b-c466-4045-b21a-fa7a17559b1c","text":[["    case \"Map\":\n    case \"Set\":\n    case \"WeakMap\":\n    case \"WeakSet\":\n      return 2/* COLLECTION */;"]],"created_time":1678248187462,"last_edited_time":1678248180000,"parent_table":"discussion","alive":true,"created_by_table":"notion_user","created_by_id":"60795f26-efa0-4fd5-b77e-d982ef21c9a3","space_id":"83c8a87b-49d0-47a1-947d-0dc6f08e4d02"}}},"notion_user":{},"collection_query":{},"signed_urls":{"500117a3-be90-4f77-8daa-302b170453a6":"https://file.notion.so/f/s/6a41814e-b5b7-4143-a4d8-35195bc24e98/Untitled.png?table=block\u0026id=500117a3-be90-4f77-8daa-302b170453a6\u0026expirationTimestamp=1679021228476\u0026signature=jQMadO6xnGOV2TclXGyJa7M9g6_MUxBYXl-VZXFymUY","e301b360-b742-425a-8092-1eb2634cc742":"https://file.notion.so/f/s/685fa767-e023-4232-9d98-b75816e90460/Untitled.png?table=block\u0026id=e301b360-b742-425a-8092-1eb2634cc742\u0026expirationTimestamp=1679021228475\u0026signature=Jib12_D6x7Sepm2ZBpjfcoh58Mzw3Y3V6FVKzy_qrlc"},"preview_images":{"notion.so/image/mmbiz.qpic.cn%2Fmmbiz_png%2Fpman3QtrTawViclZEmHCpYTwM69daBBiaoGRGpqibW0KVxLI9vVhjJpnGxrpiaf5LxxaehyweiarUlPedNCKLvCkTpw%2F640":{"originalWidth":2000,"originalHeight":1271,"dataURIBase64":"data:image/webp;base64,UklGRiwAAABXRUJQVlA4ICAAAABQAQCdASoQAAoABUB8JZwABAAAAP7wS2Blkfrlc4AAAA=="},"notion.so/image/mmbiz.qpic.cn%2Fmmbiz_png%2Fpman3QtrTawViclZEmHCpYTwM69daBBiaob6eth9iaNXTgtPH4jIESUUNeRJta6g2mOXLjzMOCdqK6uEhMNZgP0xQ%2F640":{"originalWidth":2000,"originalHeight":1240,"dataURIBase64":"data:image/webp;base64,UklGRioAAABXRUJQVlA4IB4AAAAwAQCdASoQAAoABUB8JaQAA3AA/vAwNKVIb9IAAAA="},"notion.so/image/mmbiz.qpic.cn%2Fmmbiz_png%2Fpman3QtrTawViclZEmHCpYTwM69daBBiaobASpEU3Hhcm3hKiagEhFLsIDt97O9ibu2KIxvDN7rEsrVWAl7Q8hmrTw%2F640":{"originalWidth":2000,"originalHeight":2116,"dataURIBase64":"data:image/webp;base64,UklGRiwAAABXRUJQVlA4ICAAAAAwAQCdASoPABAABUB8JaQAA3AA/vBilv+6bal6gbAAAA=="},"notion.so/image/file.notion.so%2Ff%2Fs%2F6a41814e-b5b7-4143-a4d8-35195bc24e98%2FUntitled.png":null,"data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E":null,"notion.so/image/file.notion.so%2Ff%2Fs%2F685fa767-e023-4232-9d98-b75816e90460%2FUntitled.png":null}},"pageId":"b02d7c09-9db4-480c-8082-a3631db20f71"},"__N_SSG":true},"page":"/[pageId]","query":{"pageId":"vue2与vue3响应式原理与依赖收集详解"},"buildId":"eKEPlPwVP5kYTeXwH8Gwx","isFallback":false,"dynamicIds":[635,3358],"gsp":true,"scriptLoader":[]}</script></body></html>